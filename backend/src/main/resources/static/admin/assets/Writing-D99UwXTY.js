import{_ as O,a as B,r as u,z as M,c as F,b as p,d as a,w as o,g as h,e as t,B as v,n,N as R,am as V,h as g,o as j}from"./index-ZUQ6VXyz.js";import{P as A}from"./plus-BdF9TyJ6.js";import{S as q,T as J}from"./trash-vn1EJ4oJ.js";import{i as $,j as G,N as C,k as x,l as W}from"./Space-B0xu3Oju.js";import{N as H,a as d}from"./FormItem-tc1_u1vB.js";import{N}from"./Input-DIY420FM.js";import{N as K}from"./InputNumber-BDlfI2wb.js";import{N as Q}from"./Popconfirm-DYvF9uuS.js";import"./get-slot-CI0LBECU.js";import"./Add-DtAJdb8Y.js";const X={class:"writing-page"},Y={class:"page-header"},Z={class:"pagination"},ee={style:{display:"flex","justify-content":"flex-end",gap:"12px","margin-top":"24px"}},ae={__name:"Writing",setup(te){const m=B(),b=u(!1),T=u([]),k=u(0),f=u(1),w=u(10),r=u(!1),y=u(!1),i=u({id:null,examType:"ielts",mode:"task1",title:"",prompt:"",minWords:250,tips:"[]",difficulty:"medium"}),z=[{label:"IELTS",value:"ielts"},{label:"TOEFL",value:"toefl"},{label:"CET-4",value:"cet4"},{label:"CET-6",value:"cet6"}],S=[{label:"Task 1",value:"task1"},{label:"Task 2",value:"task2"},{label:"议论文",value:"argumentative"},{label:"说明文",value:"expository"}],U=[{label:"简单",value:"easy"},{label:"中等",value:"medium"},{label:"困难",value:"hard"}],E=[{title:"ID",key:"id",width:60},{title:"标题",key:"title",width:300},{title:"考试类型",key:"examType",width:100,render:l=>n(W,{type:"info"},{default:()=>l.examType?.toUpperCase()})},{title:"模式",key:"mode",width:100},{title:"最小词数",key:"minWords",width:100},{title:"难度",key:"difficulty",width:100,render:l=>n(W,{type:l.difficulty==="hard"?"error":l.difficulty==="medium"?"warning":"success"},{default:()=>l.difficulty})},{title:"创建时间",key:"createTime",width:180,render:l=>l.createTime?new Date(l.createTime).toLocaleString("zh-CN"):"-"},{title:"操作",key:"actions",width:120,render:l=>n(C,null,{default:()=>[n(v,{size:"small",type:"primary",ghost:!0,onClick:()=>L(l)},{default:()=>n(q,{size:14})}),n(Q,{onPositiveClick:()=>P(l.id)},{trigger:()=>n(v,{size:"small",type:"error",ghost:!0},{default:()=>n(J,{size:14})}),default:()=>"确定要删除此写作话题吗？"})]})}],c=async()=>{b.value=!0;try{const l=await g.getWritingList({page:f.value,size:w.value});T.value=l.data.records,k.value=l.data.total}catch{m.error("加载数据失败")}finally{b.value=!1}},I=()=>{y.value=!1,i.value={id:null,examType:"ielts",mode:"task1",title:"",prompt:"",minWords:250,tips:"[]",difficulty:"medium"},r.value=!0},L=l=>{y.value=!0,i.value={...l},r.value=!0},P=async l=>{try{await g.deleteWriting(l),m.success("删除成功"),c()}catch{m.error("删除失败")}},_=async()=>{try{y.value?await g.updateWriting(i.value.id,i.value):await g.addWriting(i.value),m.success("保存成功"),r.value=!1,c()}catch{m.error("保存失败")}},D=l=>{f.value=l,c()};return M(()=>{c()}),(l,e)=>(j(),F("div",X,[p("header",Y,[e[11]||(e[11]=p("div",null,[p("h1",null,"写作话题管理"),p("p",null,"管理 IELTS、TOEFL 等各类写作练习话题")],-1)),a(t(v),{type:"primary",onClick:I},{icon:o(()=>[a(t(A))]),default:o(()=>[e[10]||(e[10]=h(" 添加话题 ",-1))]),_:1})]),a(t(R),{class:"content-card"},{default:o(()=>[a(t($),{columns:E,data:T.value,loading:b.value,bordered:!1,"single-line":!1},null,8,["data","loading"]),p("div",Z,[a(t(G),{page:f.value,"onUpdate:page":[e[0]||(e[0]=s=>f.value=s),D],"page-count":Math.ceil(k.value/w.value),"show-size-picker":""},null,8,["page","page-count"])])]),_:1}),a(t(V),{show:r.value,"onUpdate:show":e[9]||(e[9]=s=>r.value=s),preset:"card",title:y.value?"编辑写作话题":"添加写作话题",style:{width:"700px"}},{default:o(()=>[a(t(H),{model:i.value,"label-placement":"top"},{default:o(()=>[a(t(d),{label:"话题标题",path:"title"},{default:o(()=>[a(t(N),{value:i.value.title,"onUpdate:value":e[1]||(e[1]=s=>i.value.title=s),placeholder:"输入话题标题"},null,8,["value"])]),_:1}),a(t(C),{"item-style":"flex: 1"},{default:o(()=>[a(t(d),{label:"考试类型",path:"examType"},{default:o(()=>[a(t(x),{value:i.value.examType,"onUpdate:value":e[2]||(e[2]=s=>i.value.examType=s),options:z},null,8,["value"])]),_:1}),a(t(d),{label:"写作模式",path:"mode"},{default:o(()=>[a(t(x),{value:i.value.mode,"onUpdate:value":e[3]||(e[3]=s=>i.value.mode=s),options:S},null,8,["value"])]),_:1}),a(t(d),{label:"难度",path:"difficulty"},{default:o(()=>[a(t(x),{value:i.value.difficulty,"onUpdate:value":e[4]||(e[4]=s=>i.value.difficulty=s),options:U},null,8,["value"])]),_:1})]),_:1}),a(t(d),{label:"最小词数",path:"minWords"},{default:o(()=>[a(t(K),{value:i.value.minWords,"onUpdate:value":e[5]||(e[5]=s=>i.value.minWords=s),min:100,step:50},null,8,["value"])]),_:1}),a(t(d),{label:"写作提示/要求",path:"prompt"},{default:o(()=>[a(t(N),{value:i.value.prompt,"onUpdate:value":e[6]||(e[6]=s=>i.value.prompt=s),type:"textarea",placeholder:"输入详细的写作要求和提示",autosize:{minRows:4,maxRows:10}},null,8,["value"])]),_:1}),a(t(d),{label:"写作技巧提示 (JSON数组)",path:"tips"},{default:o(()=>[a(t(N),{value:i.value.tips,"onUpdate:value":e[7]||(e[7]=s=>i.value.tips=s),type:"textarea",placeholder:'例如: ["明确观点", "逻辑清晰"]',autosize:{minRows:2,maxRows:5}},null,8,["value"])]),_:1}),p("div",ee,[a(t(v),{onClick:e[8]||(e[8]=s=>r.value=!1)},{default:o(()=>[...e[12]||(e[12]=[h("取消",-1)])]),_:1}),a(t(v),{type:"primary",onClick:_},{default:o(()=>[...e[13]||(e[13]=[h("确定保存",-1)])]),_:1})])]),_:1},8,["model"])]),_:1},8,["show","title"])]))}},ve=O(ae,[["__scopeId","data-v-6b77e0b3"]]);export{ve as default};
