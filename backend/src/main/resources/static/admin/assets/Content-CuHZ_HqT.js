import{_ as $,a as G,r as s,z as J,c as K,b as c,d as i,w as u,g as T,e as t,B as b,n as r,N as W,ak as h,aq as X,o as g,am as Y,h as d}from"./index-ZUQ6VXyz.js";import{Q as Z}from"./QuestionEditor-DH_6lma1.js";import{P as ee}from"./plus-BdF9TyJ6.js";import{S as ae,T as te}from"./trash-vn1EJ4oJ.js";import{N as le,a as M}from"./Tabs-Cju0GC0Y.js";import{i as R,j as ie,N as E,k as x,l as S}from"./Space-B0xu3Oju.js";import{N as ne,a as v}from"./FormItem-tc1_u1vB.js";import{N}from"./Input-DIY420FM.js";import{N as ue}from"./InputNumber-BDlfI2wb.js";import{N as se}from"./Popconfirm-DYvF9uuS.js";import"./Add-DtAJdb8Y.js";import"./get-slot-CI0LBECU.js";const oe={class:"content-page"},re={class:"page-header"},de={class:"pagination"},ve={style:{display:"flex","justify-content":"flex-end",gap:"12px","margin-top":"24px"}},pe={__name:"Content",setup(fe){const y=G(),k=s(!1),o=s("listening"),z=s([]),U=s([]),D=s(0),p=s(1),C=s(10),f=s(!1),m=s(!1),P=s(null),l=s({id:null,title:"",content:"",script:"",source:"",category:"",difficulty:"Medium",type:"Conversation",wordCount:0,questions:"[]"}),q=[{label:"简单",value:"Easy"},{label:"中等",value:"Medium"},{label:"困难",value:"Hard"}],_=[{label:"对话",value:"Conversation"},{label:"讲座",value:"Lecture"},{label:"TED演讲",value:"TED"},{label:"新闻",value:"News"}],B=[{label:"科技",value:"Technology"},{label:"科普",value:"Science"},{label:"文化",value:"Culture"},{label:"历史",value:"History"},{label:"健康",value:"Health"}],L=(a,e)=>r(E,null,{default:()=>[r(b,{size:"small",type:"primary",ghost:!0,onClick:()=>A(a)},{default:()=>r(ae,{size:14})}),r(se,{onPositiveClick:()=>O(a.id,e)},{trigger:()=>r(b,{size:"small",type:"error",ghost:!0},{default:()=>r(te,{size:14})}),default:()=>`确定要删除此${e==="listening"?"听力材料":"阅读文章"}吗？`})]}),I=[{title:"ID",key:"id",width:60},{title:"标题",key:"title",width:250},{title:"类型",key:"type",width:100},{title:"难度",key:"difficulty",width:100,render:a=>r(S,{type:a.difficulty==="Hard"?"error":a.difficulty==="Medium"?"warning":"success"},{default:()=>a.difficulty})},{title:"创建时间",key:"createTime",width:180,render:a=>a.createTime?new Date(a.createTime).toLocaleString("zh-CN"):"-"},{title:"操作",key:"actions",width:120,render:a=>L(a,"listening")}],H=[{title:"ID",key:"id",width:60},{title:"标题",key:"title",width:250},{title:"分类",key:"category",width:100},{title:"难度",key:"difficulty",width:100,render:a=>r(S,{type:a.difficulty==="Hard"?"error":a.difficulty==="Medium"?"warning":"success"},{default:()=>a.difficulty})},{title:"词数",key:"wordCount",width:80},{title:"创建时间",key:"createTime",width:180,render:a=>a.createTime?new Date(a.createTime).toLocaleString("zh-CN"):"-"},{title:"操作",key:"actions",width:120,render:a=>L(a,"reading")}],w=async()=>{k.value=!0;try{const a=o.value==="listening"?await d.getListeningList({page:p.value,size:C.value}):await d.getReadingList({page:p.value,size:C.value});o.value==="listening"?z.value=a.data.records:U.value=a.data.records,D.value=a.data.total}catch{y.error("加载数据失败")}finally{k.value=!1}},V=()=>{m.value=!1,l.value={id:null,title:"",content:"",script:"",source:"",category:"Technology",difficulty:"Medium",type:"Conversation",wordCount:0,questions:"[]"},f.value=!0},A=(a,e)=>{m.value=!0,l.value={...a},f.value=!0},O=async(a,e)=>{try{e==="listening"?await d.deleteListening(a):await d.deleteReading(a),y.success("删除成功"),w()}catch{y.error("删除失败")}},j=async()=>{try{o.value==="listening"?m.value?await d.updateListening(l.value.id,l.value):await d.addListening(l.value):m.value?await d.updateReading(l.value.id,l.value):await d.addReading(l.value),y.success("保存成功"),f.value=!1,w()}catch{y.error("保存失败")}},F=a=>{o.value=a,p.value=1,w()},Q=a=>{p.value=a,w()};return J(()=>{w()}),(a,e)=>(g(),K("div",oe,[c("header",re,[e[13]||(e[13]=c("div",null,[c("h1",null,"内容管理"),c("p",null,"维护平台的听力、阅读等核心学习素材")],-1)),i(t(b),{type:"primary",onClick:V},{icon:u(()=>[i(t(ee))]),default:u(()=>[e[12]||(e[12]=T(" 添加素材 ",-1))]),_:1})]),i(t(W),{class:"content-card"},{default:u(()=>[i(t(le),{value:o.value,type:"segment",animated:"","onUpdate:value":F},{default:u(()=>[i(t(M),{name:"listening",tab:"听力材料"},{default:u(()=>[i(t(R),{columns:I,data:z.value,loading:k.value,bordered:!1,"single-line":!1},null,8,["data","loading"])]),_:1}),i(t(M),{name:"reading",tab:"阅读文章"},{default:u(()=>[i(t(R),{columns:H,data:U.value,loading:k.value,bordered:!1,"single-line":!1},null,8,["data","loading"])]),_:1})]),_:1},8,["value"]),c("div",de,[i(t(ie),{page:p.value,"onUpdate:page":[e[0]||(e[0]=n=>p.value=n),Q],"page-count":Math.ceil(D.value/C.value),"show-size-picker":""},null,8,["page","page-count"])])]),_:1}),i(t(Y),{show:f.value,"onUpdate:show":e[11]||(e[11]=n=>f.value=n),preset:"card",title:m.value?"编辑内容":"添加内容",style:{width:"800px"}},{default:u(()=>[i(t(ne),{ref_key:"formRef",ref:P,model:l.value,"label-placement":"top"},{default:u(()=>[i(t(v),{label:"标题",path:"title"},{default:u(()=>[i(t(N),{value:l.value.title,"onUpdate:value":e[1]||(e[1]=n=>l.value.title=n),placeholder:"输入内容标题"},null,8,["value"])]),_:1}),i(t(E),{"item-style":"flex: 1"},{default:u(()=>[i(t(v),{label:o.value==="listening"?"听力类型":"文章分类",path:"category"},{default:u(()=>[o.value==="listening"?(g(),h(t(x),{key:0,value:l.value.type,"onUpdate:value":e[2]||(e[2]=n=>l.value.type=n),options:_},null,8,["value"])):(g(),h(t(x),{key:1,value:l.value.category,"onUpdate:value":e[3]||(e[3]=n=>l.value.category=n),options:B},null,8,["value"]))]),_:1},8,["label"]),i(t(v),{label:"难度等级",path:"difficulty"},{default:u(()=>[i(t(x),{value:l.value.difficulty,"onUpdate:value":e[4]||(e[4]=n=>l.value.difficulty=n),options:q},null,8,["value"])]),_:1}),o.value==="reading"?(g(),h(t(v),{key:0,label:"词数",path:"wordCount"},{default:u(()=>[i(t(ue),{value:l.value.wordCount,"onUpdate:value":e[5]||(e[5]=n=>l.value.wordCount=n),min:0},null,8,["value"])]),_:1})):X("",!0)]),_:1}),i(t(v),{label:o.value==="listening"?"听力原文/脚本":"文章正文",path:"content"},{default:u(()=>[o.value==="listening"?(g(),h(t(N),{key:0,value:l.value.script,"onUpdate:value":e[6]||(e[6]=n=>l.value.script=n),type:"textarea",placeholder:"输入原文内容",autosize:{minRows:5,maxRows:15}},null,8,["value"])):(g(),h(t(N),{key:1,value:l.value.content,"onUpdate:value":e[7]||(e[7]=n=>l.value.content=n),type:"textarea",placeholder:"输入正文内容",autosize:{minRows:5,maxRows:15}},null,8,["value"]))]),_:1},8,["label"]),i(t(v),{label:"题目 (可视化编辑)",path:"questions"},{default:u(()=>[i(Z,{value:l.value.questions,"onUpdate:value":e[8]||(e[8]=n=>l.value.questions=n)},null,8,["value"])]),_:1}),i(t(v),{label:"来源 (可选)",path:"source"},{default:u(()=>[i(t(N),{value:l.value.source,"onUpdate:value":e[9]||(e[9]=n=>l.value.source=n),placeholder:"如：Economist, TED"},null,8,["value"])]),_:1}),c("div",ve,[i(t(b),{onClick:e[10]||(e[10]=n=>f.value=!1)},{default:u(()=>[...e[14]||(e[14]=[T("取消",-1)])]),_:1}),i(t(b),{type:"primary",onClick:j},{default:u(()=>[...e[15]||(e[15]=[T("确定保存",-1)])]),_:1})])]),_:1},8,["model"])]),_:1},8,["show","title"])]))}},ze=$(pe,[["__scopeId","data-v-ecaab4b0"]]);export{ze as default};
