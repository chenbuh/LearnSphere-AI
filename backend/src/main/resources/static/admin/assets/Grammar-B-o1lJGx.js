import{_ as B,a as M,r as n,z as U,c as V,b as d,d as t,w as i,g as h,e as l,B as c,n as u,N as j,am as A,h as y,o as E}from"./index-ZUQ6VXyz.js";import{Q as I}from"./QuestionEditor-DH_6lma1.js";import{P as L}from"./plus-BdF9TyJ6.js";import{S as O,T as F}from"./trash-vn1EJ4oJ.js";import{i as Q,j as J,N as T,k as x,l as $}from"./Space-B0xu3Oju.js";import{N as H,a as N}from"./FormItem-tc1_u1vB.js";import{N as K}from"./Popconfirm-DYvF9uuS.js";import"./Input-DIY420FM.js";import"./get-slot-CI0LBECU.js";const R={class:"grammar-page"},W={class:"page-header"},X={class:"pagination"},Y={style:{display:"flex","justify-content":"flex-end",gap:"12px","margin-top":"24px"}},Z={__name:"Grammar",setup(ee){const p=M(),g=n(!1),b=n([]),w=n(0),f=n(1),k=n(10),r=n(!1),m=n(!1),s=n({id:null,topic:"Tenses",difficulty:"medium",questions:"[]"}),C=[{label:"时态（Tenses）",value:"Tenses"},{label:"语态（Voice）",value:"Voice"},{label:"从句（Clauses）",value:"Clauses"},{label:"虚拟语气（Subjunctive）",value:"Subjunctive"},{label:"非谓语（Non-finite）",value:"Non-finite"},{label:"介词（Prepositions）",value:"Prepositions"},{label:"冠词（Articles）",value:"Articles"}],_=[{label:"简单",value:"easy"},{label:"中等",value:"medium"},{label:"困难",value:"hard"}],S=[{title:"ID",key:"id",width:60},{title:"语法主题",key:"topic",width:200},{title:"难度",key:"difficulty",width:100,render:e=>u($,{type:e.difficulty==="hard"?"error":e.difficulty==="medium"?"warning":"success"},{default:()=>e.difficulty})},{title:"题目数量",key:"questions",width:100,render:e=>{try{const a=JSON.parse(e.questions||"[]");return u("span",a.length+" 题")}catch{return u("span","0 题")}}},{title:"创建时间",key:"createTime",width:180,render:e=>e.createTime?new Date(e.createTime).toLocaleString("zh-CN"):"-"},{title:"操作",key:"actions",width:120,render:e=>u(T,null,{default:()=>[u(c,{size:"small",type:"primary",ghost:!0,onClick:()=>z(e)},{default:()=>u(O,{size:14})}),u(K,{onPositiveClick:()=>P(e.id)},{trigger:()=>u(c,{size:"small",type:"error",ghost:!0},{default:()=>u(F,{size:14})}),default:()=>"确定要删除此语法练习吗？"})]})}],v=async()=>{g.value=!0;try{const e=await y.getGrammarList({page:f.value,size:k.value});b.value=e.data.records,w.value=e.data.total}catch{p.error("加载数据失败")}finally{g.value=!1}},q=()=>{m.value=!1,s.value={id:null,topic:"Tenses",difficulty:"medium",questions:"[]"},r.value=!0},z=e=>{m.value=!0,s.value={...e},r.value=!0},P=async e=>{try{await y.deleteGrammar(e),p.success("删除成功"),v()}catch{p.error("删除失败")}},D=async()=>{try{m.value?await y.updateGrammar(s.value.id,s.value):await y.addGrammar(s.value),p.success("保存成功"),r.value=!1,v()}catch{p.error("保存失败")}},G=e=>{f.value=e,v()};return U(()=>{v()}),(e,a)=>(E(),V("div",R,[d("header",W,[a[7]||(a[7]=d("div",null,[d("h1",null,"语法练习管理"),d("p",null,"管理各类语法知识点的练习题目")],-1)),t(l(c),{type:"primary",onClick:q},{icon:i(()=>[t(l(L))]),default:i(()=>[a[6]||(a[6]=h(" 添加练习 ",-1))]),_:1})]),t(l(j),{class:"content-card"},{default:i(()=>[t(l(Q),{columns:S,data:b.value,loading:g.value,bordered:!1,"single-line":!1},null,8,["data","loading"]),d("div",X,[t(l(J),{page:f.value,"onUpdate:page":[a[0]||(a[0]=o=>f.value=o),G],"page-count":Math.ceil(w.value/k.value),"show-size-picker":""},null,8,["page","page-count"])])]),_:1}),t(l(A),{show:r.value,"onUpdate:show":a[5]||(a[5]=o=>r.value=o),preset:"card",title:m.value?"编辑语法练习":"添加语法练习",style:{width:"800px"}},{default:i(()=>[t(l(H),{model:s.value,"label-placement":"top"},{default:i(()=>[t(l(T),{"item-style":"flex: 1"},{default:i(()=>[t(l(N),{label:"语法主题",path:"topic"},{default:i(()=>[t(l(x),{value:s.value.topic,"onUpdate:value":a[1]||(a[1]=o=>s.value.topic=o),options:C},null,8,["value"])]),_:1}),t(l(N),{label:"难度",path:"difficulty"},{default:i(()=>[t(l(x),{value:s.value.difficulty,"onUpdate:value":a[2]||(a[2]=o=>s.value.difficulty=o),options:_},null,8,["value"])]),_:1})]),_:1}),t(l(N),{label:"练习题目 (可视化编辑)",path:"questions"},{default:i(()=>[t(I,{value:s.value.questions,"onUpdate:value":a[3]||(a[3]=o=>s.value.questions=o)},null,8,["value"])]),_:1}),d("div",Y,[t(l(c),{onClick:a[4]||(a[4]=o=>r.value=!1)},{default:i(()=>[...a[8]||(a[8]=[h("取消",-1)])]),_:1}),t(l(c),{type:"primary",onClick:D},{default:i(()=>[...a[9]||(a[9]=[h("确定保存",-1)])]),_:1})])]),_:1},8,["model"])]),_:1},8,["show","title"])]))}},de=B(Z,[["__scopeId","data-v-0c46c9a2"]]);export{de as default};
