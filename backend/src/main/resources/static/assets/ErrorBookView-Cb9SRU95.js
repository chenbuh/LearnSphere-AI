import{_ as P,l as R}from"./index-CZUTEx94.js";import{R as q,aj as I,ak as U,W as V,b as x,al as L,am as D}from"./lucide-DtS2HtB5.js";import{a6 as F,r as c,w as k,S as H,I as d,z as i,F as a,s as n,q as l,H as v,u as o,L as f,K as z,J as N,a2 as C,a8 as J,X as r,a7 as M,as as O,au as W,aC as $,p as j,ad as K,aP as Q,aQ as X,ab as G,aR as Y,$ as Z}from"./naive-ui-CN0IOFzZ.js";import"./echarts-5QPu3XI4.js";const ee={class:"page-container"},ae={class:"page-header-row"},se={class:"header-actions"},te={class:"tabs-container"},oe={class:"tab-label"},ne={key:0,class:"loading-state"},le={key:1,class:"error-list"},ie={class:"card-top"},re={class:"date-text"},ce={class:"question-body"},de={class:"answer-comparison"},pe={class:"answer-box user"},ue={class:"content"},me={class:"answer-box correct"},ve={class:"content"},ge={class:"explanation-section"},_e={class:"explanation-text"},fe={class:"note-area"},ye={class:"card-footer"},we={class:"pagination-footer"},be={key:2,class:"empty-state"},he={__name:"ErrorBookView",setup(xe){const w=F(),y=c(!1),p=c([]),u=c("all"),m=c(1),g=c(10),b=c(0),T=[{name:"all",label:"全部错题",icon:I},{name:"vocabulary",label:"词汇",icon:U},{name:"grammar",label:"语法",icon:V},{name:"reading",label:"阅读",icon:x},{name:"listening",label:"听力",icon:L}],_=async()=>{y.value=!0;try{const t={page:m.value,pageSize:g.value,isCorrect:0,contentType:u.value==="all"?void 0:u.value},e=await R.getRecords(t);e.code===200&&(p.value=e.data.records.map(B),b.value=e.data.total)}catch(t){console.error(t),w.error("加载错题失败")}finally{y.value=!1}},B=t=>{let e={};try{t.originalContent&&(e=JSON.parse(t.originalContent))}catch{}return{id:t.id,type:t.contentType,question:e.question||e.text||e.title||t.answer||"未知题目",userAnswer:t.answer,correctAnswer:t.correctAnswer,explanation:e.explanation||"暂无解析",note:"",date:new Date(t.createTime).toLocaleDateString(),details:e}};k([u,g],()=>{m.value=1,_()}),k(m,()=>{_()}),H(()=>{_()});const S=t=>{p.value=p.value.filter(e=>e.id!==t),w.success("已移除")},E=t=>({vocabulary:"success",grammar:"info",reading:"warning",listening:"error"})[t]||"default",A=t=>({vocabulary:"词汇",grammar:"语法",reading:"阅读",listening:"听力"})[t]||t;return(t,e)=>(i(),d("div",ee,[a("div",ae,[e[4]||(e[4]=a("div",{class:"header-text"},[a("h1",null,"错题本 (Error Book)"),a("p",null,"温故而知新，攻克薄弱环节")],-1)),a("div",se,[n(o(z),{type:"primary",size:"medium",onClick:_},{icon:l(()=>[n(o(f),{component:o(q)},null,8,["component"])]),default:l(()=>[e[3]||(e[3]=v(" 刷新列表 ",-1))]),_:1})])]),a("div",te,[n(o(M),{value:u.value,"onUpdate:value":e[0]||(e[0]=s=>u.value=s),type:"segment",animated:""},{default:l(()=>[(i(),d(N,null,C(T,s=>n(o(J),{key:s.name,name:s.name},{tab:l(()=>[a("div",oe,[n(o(f),{component:s.icon,size:"16"},null,8,["component"]),a("span",null,r(s.label),1)])]),_:2},1032,["name"])),64))]),_:1},8,["value"])]),y.value?(i(),d("div",ne,[n(o(O),{size:"large"})])):p.value.length>0?(i(),d("div",le,[(i(!0),d(N,null,C(p.value,s=>(i(),j(o(Z),{key:s.id,class:"error-card",bordered:!1},{default:l(()=>[a("div",ie,[n(o(K),{type:E(s.type),size:"small",bordered:!1},{default:l(()=>[v(r(A(s.type)),1)]),_:2},1032,["type"]),a("span",re,r(s.date),1)]),a("div",ce,[a("h3",null,r(s.question),1)]),a("div",de,[a("div",pe,[e[5]||(e[5]=a("div",{class:"label"},"您的回答",-1)),a("div",ue,r(s.userAnswer),1)]),a("div",me,[e[6]||(e[6]=a("div",{class:"label"},"正确答案",-1)),a("div",ve,r(s.correctAnswer),1)])]),a("div",ge,[n(o(Q),{"display-directive":"show"},{default:l(()=>[n(o(X),{title:"查看解析 & 笔记",name:"1"},{"header-extra":l(()=>[...e[7]||(e[7]=[a("span",{class:"detail-hint"},"Why is this wrong?",-1)])]),default:l(()=>[a("div",_e,[n(o(f),{component:o(x),size:"16",color:"#a1a1aa",class:"mr-2"},null,8,["component"]),v(" "+r(s.explanation),1)]),a("div",fe,[n(o(G),{type:"textarea",placeholder:"添加笔记 (暂保存在本地)...",value:s.note,"onUpdate:value":h=>s.note=h,autosize:{minRows:2},class:"note-input"},null,8,["value","onUpdate:value"])])]),_:2},1024)]),_:2},1024)]),a("div",ye,[n(o(Y),{onPositiveClick:h=>S(s.id)},{trigger:l(()=>[n(o(z),{size:"small",type:"error",ghost:""},{icon:l(()=>[n(o(f),{component:o(D)},null,8,["component"])]),default:l(()=>[e[8]||(e[8]=v(" 移除 ",-1))]),_:1})]),default:l(()=>[e[9]||(e[9]=v(" 确认将此题移出错题本吗？ ",-1))]),_:1},8,["onPositiveClick"])])]),_:2},1024))),128)),a("div",we,[n(o(W),{page:m.value,"onUpdate:page":e[1]||(e[1]=s=>m.value=s),"page-size":g.value,"onUpdate:pageSize":e[2]||(e[2]=s=>g.value=s),"item-count":b.value,"show-size-picker":"","page-sizes":[10,20,50]},null,8,["page","page-size","item-count"])])])):(i(),d("div",be,[n(o($),{description:"太棒了！该分类下没有错题。",size:"large"})]))]))}},Te=P(he,[["__scopeId","data-v-77426e03"]]);export{Te as default};
