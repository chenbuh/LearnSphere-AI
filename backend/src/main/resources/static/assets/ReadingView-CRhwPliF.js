import{a as E}from"./ai-CYMBpxnS.js";import{Y as A,_ as le,af as ae,r as m,V as S,o as ne,bm as ie,v as ce,g as v,b as i,k as w,e,d as l,w as a,u as o,a2 as j,a3 as P,j as d,ak as re,F as g,x as h,n as x,t as u,h as ue,bq as de,B as ve,a1 as V,i as b,y as z,c as k,ad as I,bn as pe,al as ye,am as _e,a8 as fe,z as ge,D as me,aj as he}from"./index-DxUHCA-q.js";import{S as ke}from"./sparkles-D4bHfN33.js";import{U as be}from"./users-52l--UN_.js";import{F as Ce}from"./file-text-DmJNb7cX.js";import{R as we}from"./rocket-BIuDXovD.js";import{H as xe}from"./history-DU2rBN7r.js";import{R as qe}from"./rotate-ccw-C4DsUMxD.js";import{C as ze}from"./clock-BMOIfxbi.js";import{C as Ne}from"./circle-check-Ch9ZOaK_.js";import{C as Me}from"./circle-x-CwYtcpQZ.js";import{N as Ae}from"./Result-BjByxIDK.js";import{N as Le}from"./Thing-C1BPltNf.js";const Be=A("dna",[["path",{d:"m10 16 1.5 1.5",key:"11lckj"}],["path",{d:"m14 8-1.5-1.5",key:"1ohn8i"}],["path",{d:"M15 2c-1.798 1.998-2.518 3.995-2.807 5.993",key:"80uv8i"}],["path",{d:"m16.5 10.5 1 1",key:"696xn5"}],["path",{d:"m17 6-2.891-2.891",key:"xu6p2f"}],["path",{d:"M2 15c6.667-6 13.333 0 20-6",key:"1pyr53"}],["path",{d:"m20 9 .891.891",key:"3xwk7g"}],["path",{d:"M3.109 14.109 4 15",key:"q76aoh"}],["path",{d:"m6.5 12.5 1 1",key:"cs35ky"}],["path",{d:"m7 18 2.891 2.891",key:"1sisit"}],["path",{d:"M9 22c1.798-1.998 2.518-3.995 2.807-5.993",key:"q3hbxp"}]]);const Re=A("feather",[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]]);const Se=A("heart-pulse",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]]);const Pe=A("leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);const Ve=A("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),He={class:"page-container"},$e={key:0,class:"page-header"},je={key:1,class:"setup-container"},Ie={class:"setting-section"},De={class:"grid-options source-grid"},Fe=["onClick"],Te={class:"option-icon"},Ue={class:"option-label"},Ee={class:"setting-section"},Qe={class:"grid-options category-grid"},Oe=["onClick"],Ge={class:"icon-wrapper"},Je={class:"info"},We={class:"option-label"},Xe={class:"option-desc"},Ye={class:"side-settings"},Ze={class:"setting-section"},Ke={class:"pill-options"},et=["onClick"],tt={class:"setting-section"},st={class:"pill-options"},ot=["onClick"],lt={key:0,class:"history-section"},at={class:"section-title"},nt={class:"history-title"},it={class:"history-footer"},ct={class:"word-count"},rt={key:0,class:"pagination-wrapper mt-6"},ut={key:0,class:"reading-container"},dt={class:"back-button-container mb-6"},vt={class:"reading-layout-container"},pt={class:"sidebar"},yt={class:"sticky-nav"},_t={class:"question-grid"},ft={class:"progress-card p-4 bg-gray-800/50 rounded-xl border border-white/5"},gt={class:"text-xs text-gray-400 mb-2 flex justify-between"},mt={class:"main-content-area"},ht={class:"article-header"},kt={class:"meta"},bt={class:"article-content"},Ct={class:"question-content"},wt={class:"q-text"},xt={class:"q-num"},qt={class:"options-container"},zt=["onClick"],Nt={class:"option-index"},Mt={class:"option-text"},At={class:"actions-footer"},Lt={key:3,class:"result-container"},Bt={key:4,class:"review-container"},Rt={class:"back-button-container"},St={class:"article-preview mb-6"},Pt={class:"text-white mb-2"},Vt={class:"preview-text p-4 bg-black/20 rounded-lg"},Ht={class:"mb-2 text-white"},$t={class:"review-detail"},jt={class:"your-answer mb-1"},It={class:"correct-answer mb-2"},Dt={class:"success-text"},Ft={class:"explanation p-3 bg-zinc-800/50 rounded text-zinc-300"},Tt={__name:"ReadingView",setup(Ut){const L=ae(),f=m("setup"),H=m(!1),p=m(0),_=m({}),B=m(0),r=m(null),N=m([]),$=m(1),q=m(6),C=m({source:"economist",category:"tech",difficulty:"medium",length:"medium"}),Q=[{label:"ç»æµå­¦äºº",value:"economist",icon:"ğŸ“ˆ"},{label:"çº½çº¦æ—¶æŠ¥",value:"nyt",icon:"ğŸ“°"},{label:"ç§‘å­¦ç¾å›½äºº",value:"scientific",icon:"ğŸ§¬"},{label:"å›½å®¶åœ°ç†",value:"natgeo",icon:"ğŸŒ"},{label:"ç»å…¸åè‘—",value:"classic",icon:"ğŸ“š"},{label:"ç°ä»£å°è¯´",value:"fiction",icon:"ğŸ–Šï¸"}],O=[{label:"ç§‘æŠ€å‰æ²¿",value:"tech",icon:ke,desc:"AI, Space, Bio"},{label:"å•†ä¸šè´¢ç»",value:"business",icon:de,desc:"Market, Economy"},{label:"äººæ–‡å†å²",value:"culture",icon:Re,desc:"History, Art"},{label:"è‡ªç„¶ç¯å¢ƒ",value:"environment",icon:Pe,desc:"Nature, Climate"},{label:"ç¤¾ä¼šç”Ÿæ´»",value:"society",icon:be,desc:"Culture, People"},{label:"è‰ºæœ¯æ–‡å­¦",value:"arts",icon:Ve,desc:"Design, Literature"},{label:"å¥åº·åŒ»ç–—",value:"health",icon:Se,desc:"Medicine, Wellness"},{label:"åŸºç¡€ç§‘å­¦",value:"science",icon:Be,desc:"Physics, Chem"}],G=[{label:"å…¥é—¨",value:"easy"},{label:"è¿›é˜¶",value:"medium"},{label:"ç²¾é€š",value:"hard"}],J=[{label:"çŸ­ç¯‡",value:"short"},{label:"ä¸­ç¯‡",value:"medium"},{label:"é•¿ç¯‡",value:"long"}],W=S(()=>f.value==="reading"&&Object.keys(_.value).length>0),D=c=>{if(W.value)return c.preventDefault(),c.returnValue="é˜…è¯»ç»ƒä¹ æ­£åœ¨è¿›è¡Œä¸­ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿä½ çš„ç­”é¢˜è¿›åº¦å°†ä¼šä¸¢å¤±ã€‚",c.returnValue},R=(c,t)=>{C.value[c]=t},X=S(()=>{const c=($.value-1)*q.value,t=c+q.value;return N.value.slice(c,t)});ne(()=>{F(),window.addEventListener("beforeunload",D)}),ie(()=>{window.removeEventListener("beforeunload",D)});const F=async()=>{try{const c=await E.getReadingHistory();c.code===200&&(N.value=c.data||[])}catch(c){console.error("Failed to fetch history",c)}},Y=c=>{r.value=c,_.value={},p.value=0,B.value=0,f.value="reading"},Z=async()=>{H.value=!0;try{const c=await E.generateReading(C.value);c.code===200&&c.data?(r.value=c.data,(!r.value.questions||r.value.questions.length===0)&&L.warning("æœªç”Ÿæˆé¢˜ç›®ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®"),p.value=0,_.value={},f.value="reading",L.success("é˜…è¯»ææ–™ç”ŸæˆæˆåŠŸ"),F()):L.error("ç”Ÿæˆå¤±è´¥")}catch(c){console.error(c),L.error("ç½‘ç»œè¯·æ±‚å¤±è´¥")}finally{H.value=!1}},K=c=>{_.value[p.value]=c},ee=()=>{p.value<r.value.questions.length-1&&p.value++},te=()=>{p.value>0&&p.value--},se=async()=>{let c=0;const t=r.value.questions;for(let y=0;y<t.length;y++){const s=t[y],n=_.value[y],M=n===s.correct;M&&c++;try{await he.createRecord({contentId:r.value.id||y,contentType:"reading",isCorrect:M?1:0,answer:n!==void 0?String(n):"-1",correctAnswer:String(s.correct),masteryLevel:M?3:1,originalContent:JSON.stringify({title:r.value.title,content:r.value.content,question:s})})}catch(oe){console.error("Failed to save record",oe)}}B.value=Math.round(c/t.length*100),f.value="result"},T=()=>{f.value="setup",_.value={},p.value=0,B.value=0,r.value=null},U=S(()=>!r.value||r.value.questions.length===0?0:(p.value+1)/r.value.questions.length*100);return S(()=>r.value?r.value.questions.filter((c,t)=>_.value[t]!==c.correct):[]),(c,t)=>{const y=ce("n-icon");return i(),v("div",He,[f.value==="setup"?(i(),v("div",$e,[...t[4]||(t[4]=[e("h1",null,"é˜…è¯»ç†è§£è®­ç»ƒ",-1),e("p",null,"ç²¾é€‰å…¨çƒå¤–åˆŠä¸ç»å…¸åè‘—ï¼Œæ·±åº¦æå‡é˜…è¯»ç†è§£èƒ½åŠ›",-1)])])):w("",!0),f.value==="setup"?(i(),v("div",je,[l(o(z),{class:"setup-card",bordered:!1,size:"huge"},{default:a(()=>[l(o(j),{"x-gap":"40","y-gap":"40",cols:"1 800:3",responsive:"screen"},{default:a(()=>[l(o(P),{span:"2"},{default:a(()=>[e("div",Ie,[e("h3",null,[l(y,{component:o(re),color:"#6366f1"},null,8,["component"]),t[5]||(t[5]=d(" é˜…è¯»æ¥æº",-1))]),e("div",De,[(i(),v(g,null,h(Q,s=>e("div",{key:s.value,class:x(["option-card",{active:C.value.source===s.value}]),onClick:n=>R("source",s.value)},[e("span",Te,u(s.icon),1),e("span",Ue,u(s.label),1)],10,Fe)),64))])]),e("div",Ee,[e("h3",null,[l(y,{component:o(ue),color:"#a855f7"},null,8,["component"]),t[6]||(t[6]=d(" æ–‡ç« é¢˜æ",-1))]),e("div",Qe,[(i(),v(g,null,h(O,s=>e("div",{key:s.value,class:x(["option-card category-card",{active:C.value.category===s.value}]),onClick:n=>R("category",s.value)},[e("div",Ge,[l(y,{component:s.icon},null,8,["component"])]),e("div",Je,[e("div",We,u(s.label),1),e("div",Xe,u(s.desc),1)])],10,Oe)),64))])])]),_:1}),l(o(P),null,{default:a(()=>[e("div",Ye,[e("div",Ze,[e("h3",null,[l(y,{component:o(ve),color:"#eab308"},null,8,["component"]),t[7]||(t[7]=d(" éš¾åº¦ç­‰çº§",-1))]),e("div",Ke,[(i(),v(g,null,h(G,s=>e("div",{key:s.value,class:x(["pill-option",{active:C.value.difficulty===s.value}]),onClick:n=>R("difficulty",s.value)},u(s.label),11,et)),64))])]),e("div",tt,[e("h3",null,[l(y,{component:o(Ce),color:"#10b981"},null,8,["component"]),t[8]||(t[8]=d(" æ–‡ç« ç¯‡å¹…",-1))]),e("div",st,[(i(),v(g,null,h(J,s=>e("div",{key:s.value,class:x(["pill-option",{active:C.value.length===s.value}]),onClick:n=>R("length",s.value)},u(s.label),11,ot)),64))])]),l(o(V)),l(o(b),{type:"primary",size:"large",block:"",round:"",class:"start-btn",loading:H.value,onClick:Z},{icon:a(()=>[l(y,{component:o(we)},null,8,["component"])]),default:a(()=>[t[9]||(t[9]=d(" ç”Ÿæˆé˜…è¯»ä»»åŠ¡ ",-1))]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1}),N.value.length>0?(i(),v("div",lt,[e("div",at,[l(y,{component:o(xe)},null,8,["component"]),t[10]||(t[10]=d(" æœ€è¿‘ç”Ÿæˆ ",-1))]),l(o(j),{"x-gap":"16","y-gap":"16",cols:"1 600:2 900:3"},{default:a(()=>[(i(!0),v(g,null,h(X.value,s=>(i(),k(o(P),{key:s.id},{default:a(()=>[l(o(z),{class:"history-card",hoverable:"",onClick:n=>Y(s)},{header:a(()=>[l(o(I),{size:"small",bordered:!1,type:"success",class:"mb-1"},{default:a(()=>[d(u(s.source),1)]),_:2},1024),e("div",nt,u(s.title),1)]),footer:a(()=>[e("div",it,[l(o(I),{size:"tiny",bordered:!1},{default:a(()=>[d(u(s.difficulty),1)]),_:2},1024),e("span",ct,u(s.questions?.length||0)+" é¢˜",1)])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),N.value.length>q.value?(i(),v("div",rt,[l(o(pe),{page:$.value,"onUpdate:page":t[0]||(t[0]=s=>$.value=s),"page-count":Math.ceil(N.value.length/q.value),"page-size":q.value,"show-size-picker":"","page-sizes":[6,12,18],"onUpdate:pageSize":t[1]||(t[1]=s=>q.value=s)},null,8,["page","page-count","page-size"])])):w("",!0)])):w("",!0)])):f.value==="reading"?(i(),v(g,{key:2},[r.value?(i(),v("div",ut,[e("div",dt,[l(o(b),{secondary:"",onClick:T},{icon:a(()=>[l(y,{component:o(qe)},null,8,["component"])]),default:a(()=>[t[11]||(t[11]=d(" è¿”å›è®¾ç½® ",-1))]),_:1})]),e("div",vt,[e("div",pt,[e("div",yt,[l(o(z),{class:"nav-card mb-4",bordered:!1,title:"é¢˜ç›®å¯¼èˆª",size:"small"},{default:a(()=>[e("div",_t,[(i(!0),v(g,null,h(r.value.questions,(s,n)=>(i(),k(o(b),{key:n,circle:"",class:x(["nav-btn",{current:p.value===n,answered:_.value[n]!=null&&p.value!==n}]),type:p.value===n?"primary":_.value[n]!=null?"success":"default",secondary:p.value!==n,onClick:M=>p.value=n},{default:a(()=>[d(u(n+1),1)]),_:2},1032,["class","type","secondary","onClick"]))),128))])]),_:1}),e("div",ft,[e("div",gt,[t[12]||(t[12]=e("span",null,"å®Œæˆè¿›åº¦",-1)),e("span",null,u(Math.round(U.value))+"%",1)]),l(o(ye),{type:"line",percentage:U.value,"show-indicator":!1,color:"#10b981","rail-color":"#3f3f46",height:6},null,8,["percentage"])])])]),e("div",mt,[l(o(z),{class:"question-card",bordered:!1,size:"large"},{default:a(()=>[e("div",ht,[l(o(I),{type:"success",size:"small"},{default:a(()=>[d(u(C.value.category.toUpperCase()),1)]),_:1}),e("h2",null,u(r.value.title),1),e("p",kt,[e("span",null,u(r.value.source),1),t[13]||(t[13]=e("span",{class:"separator"},"â€¢",-1)),e("span",null,[l(y,{component:o(ze),size:"14"},null,8,["component"]),d(" "+u(r.value.word_count||600)+" è¯",1)])])]),l(o(V)),e("div",bt,[(i(!0),v(g,null,h(r.value.content.split(`
`),(s,n)=>(i(),v("p",{key:n},u(s),1))),128))]),l(o(V)),e("div",Ct,[e("h3",wt,[e("span",xt,"Q"+u(p.value+1),1),d(" "+u(r.value.questions[p.value].text),1)]),e("div",qt,[l(o(j),{"x-gap":"20","y-gap":"20",cols:"1"},{default:a(()=>[(i(!0),v(g,null,h(r.value.questions[p.value].options,(s,n)=>(i(),k(o(P),{key:n},{default:a(()=>[e("div",{class:x(["answer-option",{selected:_.value[p.value]===n}]),onClick:M=>K(n)},[e("span",Nt,u(["A","B","C","D"][n]),1),e("span",Mt,u(s),1)],10,zt)]),_:2},1024))),128))]),_:1})])]),e("div",At,[p.value>0?(i(),k(o(b),{key:0,secondary:"",onClick:te,class:"mr-4"},{default:a(()=>[...t[14]||(t[14]=[d("ä¸Šä¸€é¢˜",-1)])]),_:1})):w("",!0),p.value<r.value.questions.length-1?(i(),k(o(b),{key:1,type:"primary",onClick:ee},{default:a(()=>[...t[15]||(t[15]=[d("ä¸‹ä¸€é¢˜",-1)])]),_:1})):(i(),k(o(b),{key:2,type:"success",onClick:se},{default:a(()=>[...t[16]||(t[16]=[d("æäº¤ç­”æ¡ˆ",-1)])]),_:1}))])]),_:1})])])])):w("",!0)],64)):f.value==="result"?(i(),v("div",Lt,[l(o(z),{class:"score-card",bordered:!1},{default:a(()=>[l(o(Ae),{status:"success",title:"é˜…è¯»å®Œæˆ",description:"ä½ çš„ç†è§£æ­£ç¡®ç‡ï¼š"+B.value+"%"},{icon:a(()=>[l(y,{component:o(fe),size:"80",color:"#eab308"},null,8,["component"])]),footer:a(()=>[l(o(_e),{justify:"center"},{default:a(()=>[l(o(b),{onClick:T},{default:a(()=>[...t[17]||(t[17]=[d("é˜…è¯»ä¸‹ä¸€ç¯‡",-1)])]),_:1}),l(o(b),{type:"primary",onClick:t[2]||(t[2]=s=>f.value="review")},{default:a(()=>[...t[18]||(t[18]=[d("æŸ¥çœ‹åŸæ–‡è§£æ",-1)])]),_:1})]),_:1})]),_:1},8,["description"])]),_:1})])):f.value==="review"?(i(),v("div",Bt,[e("div",Rt,[l(o(b),{secondary:"",onClick:t[3]||(t[3]=s=>f.value="result")},{icon:a(()=>[l(y,{component:c.ArrowLeft},null,8,["component"])]),default:a(()=>[t[19]||(t[19]=d(" è¿”å›æŠ¥å‘Š ",-1))]),_:1})]),r.value?(i(),k(o(z),{key:0,class:"review-card",title:"è¯¦ç»†è§£æ",bordered:!1},{default:a(()=>[e("div",St,[e("h3",Pt,u(r.value.title),1),e("div",Vt,[(i(!0),v(g,null,h(r.value.content.split(`
`),(s,n)=>(i(),v("p",{key:n,class:"mb-2 text-zinc-400"},u(s),1))),128))])]),l(o(V)),l(o(ge),null,{default:a(()=>[(i(!0),v(g,null,h(r.value.questions,(s,n)=>(i(),k(o(me),{key:n},{default:a(()=>[l(o(Le),{title:"Q"+(n+1)},{description:a(()=>[e("p",Ht,u(s.text),1)]),default:a(()=>[e("div",$t,[e("div",jt,[t[20]||(t[20]=d(" ä½ çš„é€‰æ‹©: ",-1)),e("span",{class:x(_.value[n]===s.correct?"success-text":"error-text")},u(s.options[_.value[n]]||"æœªä½œç­”"),3),_.value[n]===s.correct?(i(),k(y,{key:0,component:o(Ne),color:"#10b981"},null,8,["component"])):(i(),k(y,{key:1,component:o(Me),color:"#ef4444"},null,8,["component"]))]),e("div",It,[t[21]||(t[21]=d("æ­£ç¡®ç­”æ¡ˆ: ",-1)),e("span",Dt,u(s.options[s.correct]),1)]),e("div",Ft,[t[22]||(t[22]=e("strong",null,"è§£æï¼š",-1)),d(" "+u(s.explanation||"æš‚æ— è¯¦ç»†è§£æã€‚"),1)])])]),_:2},1032,["title"])]),_:2},1024))),128))]),_:1})]),_:1})):w("",!0)])):w("",!0)])}}},os=le(Tt,[["__scopeId","data-v-96f015ad"]]);export{os as default};
