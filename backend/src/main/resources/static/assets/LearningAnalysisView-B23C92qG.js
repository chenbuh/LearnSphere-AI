import{_ as D,af as M,r as c,o as U,g as d,b as u,e,d as s,w as a,j as g,u as t,f as i,i as I,k as Z,a2 as T,a3 as _,y as p,B as q,t as r,p as O,h as H,Z as J,F as B,x as V,ax as z,al as K,A as Q,ad as W,aq as X,ac as Y,aj as k,aS as $,bu as ee,bv as te}from"./index-DxUHCA-q.js";import{S as E}from"./sparkles-D4bHfN33.js";import{C as F}from"./circle-alert-ChNPzvrA.js";const se={class:"page-container"},ae={class:"page-header"},oe={class:"header-content"},le={key:0,class:"analysis-content"},ne={class:"overview-section"},re={class:"stat-content"},ie={class:"stat-icon-box purple"},ce={class:"stat-text"},de={class:"value"},ue={class:"stat-content"},pe={class:"stat-icon-box green"},_e={class:"stat-text"},ve={class:"value green"},fe={class:"stat-content"},ge={class:"stat-icon-box orange"},ye={class:"stat-text"},he={class:"value orange"},me={class:"stat-content"},be={class:"stat-icon-box blue"},xe={class:"stat-text"},we={class:"value"},ke={class:"analysis-layout"},Ce={class:"ability-list"},Ae={class:"item-header"},Se={class:"name"},Ne={class:"item-footer"},Le={class:"right-col-stack"},Ie={class:"weakness-list"},Te={class:"wp-header"},Be={class:"wp-title"},Ve={class:"wp-advice"},ze={key:1,class:"empty-state"},Ee={__name:"LearningAnalysisView",setup(Fe){const C=M(),y=c(!0),h=c(!1),m=c(null),b=c(null);let v=null;const f=c({overall:0,growth:0,gap:0,predict:0}),A=c([]),S=c([]),G=async()=>{y.value=!0;try{const o=await k.getLastAnalysis();o.code===200&&o.data?L(o.data):m.value=null}catch(o){console.error("Failed to fetch last report:",o)}finally{y.value=!1,R()}},N=async()=>{h.value=!0;try{const o=await k.generateAnalysis();o.code===200&&(L(o.data),C.success("AI 深度分析报告已重新生成"))}catch{C.error("分析生成失败，请稍后重试")}finally{h.value=!1}},L=o=>{m.value=o,f.value={overall:o.overall,growth:o.growth,gap:o.gap,predict:o.predict},A.value=o.abilities||[],S.value=o.weakPoints||[]},R=async()=>{try{const o=await k.getTrends(7);o.code===200&&$(()=>{j(o.data)})}catch(o){console.error("Trend data fail:",o)}},j=o=>{if(!b.value)return;v&&v.dispose(),v=ee(b.value,"dark");const l=o.trendStats||[],n=l.map(w=>w.date.split("-").slice(1).join("/")),x=l.map(w=>(w.accuracy*100).toFixed(1)),P={backgroundColor:"transparent",tooltip:{trigger:"axis",backgroundColor:"#27272a",borderColor:"#3f3f46",textStyle:{color:"#fff"}},grid:{top:"15%",left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:n,axisLine:{lineStyle:{color:"#3f3f46"}},axisLabel:{color:"#a1a1aa"}},yAxis:{type:"value",max:100,splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)"}},axisLabel:{color:"#a1a1aa",formatter:"{value}%"}},series:[{name:"学习准确率",type:"line",smooth:!0,data:x,lineStyle:{width:3,color:"#818cf8"},itemStyle:{color:"#818cf8"},areaStyle:{color:new te(0,0,0,1,[{offset:0,color:"rgba(129, 140, 248, 0.3)"},{offset:1,color:"rgba(129, 140, 248, 0)"}])},symbol:"circle",symbolSize:8}]};v.setOption(P)};return U(()=>{G(),window.addEventListener("resize",()=>v?.resize())}),(o,l)=>(u(),d("div",se,[e("div",ae,[e("div",oe,[l[1]||(l[1]=e("div",null,[e("h1",null,"学习分析"),e("p",null,"基于 AI 的全方位能力评估报告")],-1)),s(t(I),{type:"primary",secondary:"",round:"",loading:h.value,onClick:N},{icon:a(()=>[s(t(i),null,{default:a(()=>[s(t(E))]),_:1})]),default:a(()=>[l[0]||(l[0]=g(" 重新进行 AI 深度分析 ",-1))]),_:1},8,["loading"])])]),s(t(Y),{show:y.value},{default:a(()=>[m.value?(u(),d("div",le,[e("div",ne,[s(t(T),{"x-gap":"20","y-gap":"20",cols:"1 600:2 1000:4",responsive:"screen"},{default:a(()=>[s(t(_),null,{default:a(()=>[s(t(p),{class:"stat-card",bordered:!1},{default:a(()=>[e("div",re,[e("div",ie,[s(t(i),{component:t(q)},null,8,["component"])]),e("div",ce,[l[2]||(l[2]=e("div",{class:"label"},"综合能力值",-1)),e("div",de,r(f.value.overall),1)])])]),_:1})]),_:1}),s(t(_),null,{default:a(()=>[s(t(p),{class:"stat-card",bordered:!1},{default:a(()=>[e("div",ue,[e("div",pe,[s(t(i),{component:t(O)},null,8,["component"])]),e("div",_e,[l[3]||(l[3]=e("div",{class:"label"},"较上周提升",-1)),e("div",ve,"+"+r(f.value.growth)+"%",1)])])]),_:1})]),_:1}),s(t(_),null,{default:a(()=>[s(t(p),{class:"stat-card",bordered:!1},{default:a(()=>[e("div",fe,[e("div",ge,[s(t(i),{component:t(H)},null,8,["component"])]),e("div",ye,[l[4]||(l[4]=e("div",{class:"label"},"距目标差距",-1)),e("div",he,r(f.value.gap)+"%",1)])])]),_:1})]),_:1}),s(t(_),null,{default:a(()=>[s(t(p),{class:"stat-card",bordered:!1},{default:a(()=>[e("div",me,[e("div",be,[s(t(i),{component:t(J)},null,8,["component"])]),e("div",xe,[l[5]||(l[5]=e("div",{class:"label"},"预测分值 (CET)",-1)),e("div",we,r(f.value.predict),1)])])]),_:1})]),_:1})]),_:1})]),e("div",ke,[s(t(T),{"x-gap":"24","y-gap":"24",cols:"1 900:3",responsive:"screen"},{default:a(()=>[s(t(_),{span:"1"},{default:a(()=>[s(t(p),{title:"能力分布",class:"ability-card",bordered:!1},{"header-extra":a(()=>[s(t(i),{component:t(Q),color:"#a1a1aa"},null,8,["component"])]),default:a(()=>[e("div",Ce,[(u(!0),d(B,null,V(A.value,n=>(u(),d("div",{key:n.name,class:"ability-item"},[e("div",Ae,[e("span",Se,r(n.name),1),e("span",{class:"score",style:z({color:n.color})},r(n.current)+"%",5)]),s(t(K),{type:"line",percentage:n.current,color:n.color,"rail-color":"rgba(255,255,255,0.1)",height:6,"show-indicator":!1},null,8,["percentage","color"]),e("div",{class:"target-line",style:z({left:n.target+"%"})},null,4),e("div",Ne," 目标: "+r(n.target)+"% ",1)]))),128))])]),_:1})]),_:1}),s(t(_),{span:"2"},{default:a(()=>[e("div",Le,[s(t(p),{title:"薄弱项诊断 & 建议",class:"advice-card",bordered:!1},{"header-extra":a(()=>[s(t(i),{component:t(F),color:"#ef4444"},null,8,["component"])]),default:a(()=>[e("div",Ie,[(u(!0),d(B,null,V(S.value,(n,x)=>(u(),d("div",{key:x,class:"weakness-item"},[e("div",Te,[e("div",Be,[s(t(i),{component:t(F),color:n.color,class:"mr-2",style:{"margin-right":"8px"}},null,8,["component","color"]),g(" "+r(n.title),1)]),s(t(W),{color:{color:"rgba(239, 68, 68, 0.1)",textColor:"#ef4444"},size:"small",bordered:!1},{default:a(()=>[g(" 得分: "+r(n.score),1)]),_:2},1024)]),e("div",Ve,[l[6]||(l[6]=e("span",{class:"label"},"AI 建议:",-1)),g(" "+r(n.advice),1)])]))),128))])]),_:1}),s(t(p),{title:"学习准确率趋势",class:"trend-card",bordered:!1},{default:a(()=>[e("div",{ref_key:"trendChartRef",ref:b,class:"trend-chart"},null,512)]),_:1})])]),_:1})]),_:1})])])):y.value?Z("",!0):(u(),d("div",ze,[s(t(X),{description:"尚未生成分析报告，点击上方按钮开启 AI 深度分析"},{extra:a(()=>[s(t(I),{type:"primary",loading:h.value,onClick:N},{icon:a(()=>[s(t(i),null,{default:a(()=>[s(t(E))]),_:1})]),default:a(()=>[l[7]||(l[7]=g(" 立即生成分析报告 ",-1))]),_:1},8,["loading"])]),_:1})]))]),_:1},8,["show"])]))}},Pe=D(Ee,[["__scopeId","data-v-88560816"]]);export{Pe as default};
