import{a as A}from"./ai-CYMBpxnS.js";import{Y as D,_ as te,af as se,r as f,V,o as ae,bm as oe,aN as le,a as ne,v as ie,g as c,b as i,k as L,e as t,d as l,w as n,u as a,a2 as P,a3 as B,j as u,F as w,x as C,n as E,t as r,h as re,br as ce,a1 as ue,i as T,y as N,c as I,ad as U,bn as de,ab as pe,am as ve,a8 as me,z as fe,D as ge,ak as ye,aj as _e}from"./index-DxUHCA-q.js";import{G as he}from"./graduation-cap-BUyCR4-R.js";import{C as ke}from"./clock-BMOIfxbi.js";import{R as be}from"./rocket-BIuDXovD.js";import{H as we}from"./history-DU2rBN7r.js";import{R as Ce}from"./rotate-ccw-C4DsUMxD.js";import{C as Te}from"./circle-check-Ch9ZOaK_.js";import{N as ze}from"./Result-BjByxIDK.js";import{N as xe}from"./Thing-C1BPltNf.js";const Le=D("file-pen",[["path",{d:"M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34",key:"o6klzx"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z",key:"zhnas1"}]]);const Ne=D("pen-tool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);const Ie=D("spell-check",[["path",{d:"m6 16 6-12 6 12",key:"1b4byz"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]]),Se={class:"page-container"},Me={key:0,class:"page-header"},Ve={key:1,class:"setup-container"},He={class:"setting-section"},We={class:"grid-options exam-grid"},Ae=["onClick"],Be={class:"option-icon"},Ee={class:"option-label"},Ue={class:"setting-section"},De={class:"grid-options mode-grid"},Fe=["onClick"],Re={class:"icon-wrapper"},$e={class:"info"},Pe={class:"option-label"},Ge={class:"option-desc"},je={class:"side-settings"},qe={class:"setting-section"},Oe={class:"pill-options"},Je=["onClick"],Ye={key:0,class:"history-section mt-12"},Ke={class:"section-title"},Qe=["onClick"],Xe={class:"history-card-header"},Ze={class:"topic-title"},et={class:"topic-preview"},tt={key:0,class:"pagination-wrapper mt-6"},st={key:2,class:"writing-container"},at={class:"back-button-container"},ot={class:"writing-layout"},lt={class:"topic-header"},nt={class:"word-req"},it={class:"topic-prompt"},rt={class:"topic-tips"},ct={class:"editor-footer"},ut={class:"stats"},dt={key:0},pt={class:"actions"},vt={key:3,class:"result-container"},mt={__name:"WritingView",setup(ft){const y=se(),p=f("setup"),S=f(!1),v=f(""),m=f(null),_=f(null),z=f([]),H=f(1),b=f(6),g=f({examType:"cet4",mode:"essay",timeLimit:30}),G=[{value:"cet4",label:"CET-4",icon:"4"},{value:"cet6",label:"CET-6",icon:"6"},{value:"ielts",label:"IELTS",icon:"I"},{value:"toefl",label:"TOEFL",icon:"T"}],j=[{value:"essay",label:"ËÆÆËÆ∫Êñá",desc:"Discuss both views & give opinion",icon:Le},{value:"chart",label:"ÂõæË°®‰ΩúÊñá",desc:"Describe trends in charts/graphs",icon:re},{value:"letter",label:"Â∫îÁî®Êñá/‰π¶‰ø°",desc:"Formal/Informal letters",icon:ce}],q=[{value:0,label:"‰∏çÈôêÊó∂"},{value:30,label:"30ÂàÜÈíü"},{value:45,label:"45ÂàÜÈíü"},{value:60,label:"60ÂàÜÈíü"}],h=f(0);let M=null;const O=V(()=>p.value==="writing"&&v.value.length>0),F=o=>{if(O.value)return o.preventDefault(),o.returnValue="ÂÜô‰ΩúÊ≠£Âú®ËøõË°å‰∏≠ÔºåÁ°ÆÂÆöË¶ÅÁ¶ªÂºÄÂêóÔºü‰Ω†ÁöÑÊñáÁ´†ÂÜÖÂÆπÂ∞Ü‰ºö‰∏¢Â§±„ÄÇ",o.returnValue};ae(()=>{window.addEventListener("beforeunload",F),Q()}),oe(()=>{window.removeEventListener("beforeunload",F)}),le(p,o=>{o==="writing"&&g.value.timeLimit>0?(h.value=g.value.timeLimit*60,J()):x()});const J=()=>{x(),M=setInterval(()=>{h.value>0?h.value--:(x(),y.warning("Êó∂Èó¥Âà∞ÔºÅ"))},1e3)},x=()=>{M&&(clearInterval(M),M=null)};ne(()=>{x()});const Y=V(()=>{if(h.value<=0)return"00:00";const o=Math.floor(h.value/60),e=h.value%60;return`${String(o).padStart(2,"0")}:${String(e).padStart(2,"0")}`}),W=(o,e)=>{g.value[o]=e},K=V(()=>{const o=(H.value-1)*b.value,e=o+b.value;return z.value.slice(o,e)}),Q=async()=>{try{const o=await A.getWritingHistory();o.code===200&&(z.value=o.data||[])}catch(o){console.error("Failed to fetch writing history",o)}},X=o=>{m.value=o,v.value="",p.value="writing",y.success(`Â∑≤Âä†ËΩΩ: ${o.title}`)},Z=async()=>{S.value=!0;try{const o=await A.generateWriting({examType:g.value.examType,mode:g.value.mode});o.code===200&&o.data?(m.value=o.data,v.value="",p.value="writing",y.success("È¢òÁõÆÁîüÊàêÊàêÂäü")):y.error("ÁîüÊàêÂ§±Ë¥•")}catch(o){console.error(o),y.error("ÁΩëÁªúËØ∑Ê±ÇÂ§±Ë¥•")}finally{S.value=!1}},ee=async()=>{S.value=!0;try{const o=await A.evaluateWriting({topic:m.value.title,content:v.value});if(o.code===200&&o.data){_.value=o.data,p.value="result",y.success("ÊâπÊîπÂÆåÊàê");try{await _e.createRecord({contentId:m.value.id||0,contentType:"writing",isCorrect:_.value.score>=60?1:0,answer:v.value,correctAnswer:"N/A",score:_.value.score,masteryLevel:Math.floor(_.value.score/20),originalContent:JSON.stringify({topic:m.value,feedback:_.value.feedback})})}catch(e){console.error("Failed to save writing record",e)}}else y.error("ÊâπÊîπÂ§±Ë¥•")}catch(o){console.error(o),y.error("ËØ∑Ê±ÇÂ§±Ë¥•")}finally{S.value=!1}},R=()=>{p.value="setup",v.value="",m.value=null,_.value=null,h.value=0,x()},$=V(()=>v.value?v.value.split(/\s+/).filter(o=>o).length:0);return(o,e)=>{const d=ie("n-icon");return i(),c("div",Se,[p.value==="setup"?(i(),c("div",Me,[...e[3]||(e[3]=[t("h1",null,"ÂÜô‰ΩúÊô∫ËÉΩÊâπÊîπ",-1),t("p",null,"Ê®°ÊãüÁúüÂÆûËÄÉËØïÂú∫ÊôØÔºåAI ÂÆûÊó∂ËØäÊñ≠ËØ≠Ê≥ï‰∏éÈÄªËæëÊºèÊ¥û",-1)])])):L("",!0),p.value==="setup"?(i(),c("div",Ve,[l(a(N),{class:"setup-card",bordered:!1,size:"huge"},{default:n(()=>[l(a(P),{"x-gap":"40","y-gap":"40",cols:"1 800:3",responsive:"screen"},{default:n(()=>[l(a(B),{span:"2"},{default:n(()=>[t("div",He,[t("h3",null,[l(d,{component:a(he),color:"#6366f1"},null,8,["component"]),e[4]||(e[4]=u(" ËÄÉËØïÁ±ªÂûã",-1))]),t("div",We,[(i(),c(w,null,C(G,s=>t("div",{key:s.value,class:E(["option-card",{active:g.value.examType===s.value}]),onClick:k=>W("examType",s.value)},[t("span",Be,r(s.icon),1),t("span",Ee,r(s.label),1)],10,Ae)),64))])]),t("div",Ue,[t("h3",null,[l(d,{component:a(Ne),color:"#a855f7"},null,8,["component"]),e[5]||(e[5]=u(" ÂÜô‰ΩúÈ¢òÂûã",-1))]),t("div",De,[(i(),c(w,null,C(j,s=>t("div",{key:s.value,class:E(["option-card mode-card",{active:g.value.mode===s.value}]),onClick:k=>W("mode",s.value)},[t("div",Re,[l(d,{component:s.icon},null,8,["component"])]),t("div",$e,[t("div",Pe,r(s.label),1),t("div",Ge,r(s.desc),1)])],10,Fe)),64))])])]),_:1}),l(a(B),null,{default:n(()=>[t("div",je,[t("div",qe,[t("h3",null,[l(d,{component:a(ke),color:"#eab308"},null,8,["component"]),e[6]||(e[6]=u(" ÈôêÊó∂ËÆ≠ÁªÉ",-1))]),t("div",Oe,[(i(),c(w,null,C(q,s=>t("div",{key:s.value,class:E(["pill-option",{active:g.value.timeLimit===s.value}]),onClick:k=>W("timeLimit",s.value)},r(s.label),11,Je)),64))])]),e[8]||(e[8]=t("div",{class:"tips-box"},[t("h4",null,"üí° ËÆ≠ÁªÉË¥¥Â£´"),t("p",null,"Âª∫ËÆÆÂú®ÁîµËÑëÁ´ØËøõË°åÂÜô‰ΩúËÆ≠ÁªÉÔºå‰ª•Ê®°ÊãüÁúüÂÆûËÄÉÂú∫ËæìÂÖ•‰ΩìÈ™å„ÄÇAI Â∞Ü‰ªéËØçÊ±á„ÄÅËØ≠Ê≥ï„ÄÅÈÄªËæë‰∏â‰∏™Áª¥Â∫¶Êèê‰æõËØÑÂàÜ„ÄÇ")],-1)),l(a(ue)),l(a(T),{type:"primary",size:"large",block:"",round:"",class:"start-btn",onClick:Z},{icon:n(()=>[l(d,{component:a(be)},null,8,["component"])]),default:n(()=>[e[7]||(e[7]=u(" ÁîüÊàêÈ¢òÁõÆ ",-1))]),_:1})])]),_:1})]),_:1})]),_:1}),z.value.length>0?(i(),c("div",Ye,[t("div",Ke,[l(d,{component:a(we)},null,8,["component"]),e[9]||(e[9]=u(" ÊúÄËøëÁîüÊàêÈ¢òÁõÆ ",-1))]),l(a(P),{"x-gap":"20","y-gap":"20",cols:"1 600:2 1200:3"},{default:n(()=>[(i(!0),c(w,null,C(K.value,s=>(i(),I(a(B),{key:s.id},{default:n(()=>[t("div",{class:"history-card",onClick:k=>X(s)},[t("div",Xe,[l(a(U),{size:"small",type:"warning",bordered:!1},{default:n(()=>[u(r(s.examType?.toUpperCase()),1)]),_:2},1024),l(a(U),{size:"tiny",bordered:!1},{default:n(()=>[u(r(s.mode),1)]),_:2},1024)]),t("h4",Ze,r(s.title),1),t("div",et,r(s.prompt?.substring(0,60))+"...",1)],8,Qe)]),_:2},1024))),128))]),_:1}),z.value.length>b.value?(i(),c("div",tt,[l(a(de),{page:H.value,"onUpdate:page":e[0]||(e[0]=s=>H.value=s),"page-count":Math.ceil(z.value.length/b.value),"page-size":b.value,"show-size-picker":"","page-sizes":[6,12,18],"onUpdate:pageSize":e[1]||(e[1]=s=>b.value=s)},null,8,["page","page-count","page-size"])])):L("",!0)])):L("",!0)])):p.value==="writing"?(i(),c("div",st,[t("div",at,[l(a(T),{secondary:"",onClick:R},{icon:n(()=>[l(d,{component:a(Ce)},null,8,["component"])]),default:n(()=>[e[10]||(e[10]=u(" ËøîÂõûËÆæÁΩÆ ",-1))]),_:1})]),t("div",ot,[l(a(N),{class:"topic-card",bordered:!1},{default:n(()=>[t("div",lt,[l(a(U),{type:"warning"},{default:n(()=>[...e[11]||(e[11]=[u("Task 2",-1)])]),_:1}),t("span",nt,"Min Words: "+r(m.value.minWords),1)]),t("h2",null,r(m.value.title),1),t("div",it,r(m.value.prompt),1),t("div",rt,[e[12]||(e[12]=t("strong",null,"Hints:",-1)),t("ul",null,[(i(!0),c(w,null,C(m.value.tips,(s,k)=>(i(),c("li",{key:k},r(s),1))),128))])])]),_:1}),l(a(N),{class:"editor-card",bordered:!1,"content-style":"display: flex; flex-direction: column; height: 100%;"},{default:n(()=>[l(a(pe),{value:v.value,"onUpdate:value":e[2]||(e[2]=s=>v.value=s),type:"textarea",placeholder:"Start writing here...",class:"essay-editor",bordered:!1},null,8,["value"]),t("div",ct,[t("div",ut,[t("span",null,"Words: "+r($.value),1),g.value.timeLimit>0?(i(),c("span",dt,"Time Left: "+r(Y.value),1)):L("",!0)]),t("div",pt,[l(a(T),{secondary:"",size:"large"},{default:n(()=>[...e[13]||(e[13]=[u("Â≠òËçâÁ®ø",-1)])]),_:1}),l(a(T),{type:"primary",size:"large",onClick:ee,disabled:$.value<10},{default:n(()=>[...e[14]||(e[14]=[u(" Êèê‰∫§ÊâπÊîπ ",-1)])]),_:1},8,["disabled"])])])]),_:1})])])):p.value==="result"?(i(),c("div",vt,[l(a(N),{class:"score-card",bordered:!1},{default:n(()=>[l(a(ze),{status:"success",title:"ÊâπÊîπÂÆåÊàê",description:"AI È¢Ñ‰º∞ÂàÜÊï∞Ôºö"+_.value.score},{icon:n(()=>[l(d,{component:a(me),size:"80",color:"#eab308"},null,8,["component"])]),footer:n(()=>[l(a(ve),{justify:"center"},{default:n(()=>[l(a(T),{onClick:R},{default:n(()=>[...e[15]||(e[15]=[u("ÂÜçÂÜô‰∏ÄÁØá",-1)])]),_:1}),l(a(T),{type:"primary"},{default:n(()=>[...e[16]||(e[16]=[u("ÂØºÂá∫Êä•Âëä",-1)])]),_:1})]),_:1})]),_:1},8,["description"])]),_:1}),l(a(N),{title:"ËØ¶ÁªÜÂèçÈ¶à",class:"feedback-card",bordered:!1},{default:n(()=>[l(a(fe),null,{default:n(()=>[(i(!0),c(w,null,C(_.value.feedback,(s,k)=>(i(),I(a(ge),{key:k},{default:n(()=>[l(a(xe),null,{avatar:n(()=>[s.type==="grammar"?(i(),I(d,{key:0,component:a(Ie),color:"#ef4444",size:"24"},null,8,["component"])):s.type==="vocab"?(i(),I(d,{key:1,component:a(ye),color:"#3b82f6",size:"24"},null,8,["component"])):(i(),I(d,{key:2,component:a(Te),color:"#10b981",size:"24"},null,8,["component"]))]),header:n(()=>[u(r(s.type.toUpperCase()),1)]),description:n(()=>[u(r(s.text),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):L("",!0)])}}},xt=te(mt,[["__scopeId","data-v-153feab4"]]);export{xt as default};
