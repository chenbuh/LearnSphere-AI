import{_ as pe,r as D}from"./index-CZUTEx94.js";import{G as ge,ag as fe,B as me,p as _e,t as ye,a0 as be,ah as he,T as ke,V as xe,a3 as we,ai as W,i as Ce}from"./lucide-DtS2HtB5.js";import{a6 as Se,r as g,j as h,w as Te,S as Ee,aO as ze,I as c,z as u,a1 as E,F as s,s as n,q as o,u as t,_ as R,U as z,H as d,L as Q,J as N,a2 as B,a3 as U,a4 as Ne,X as i,Y as G,K as _,$ as w,p as I,ad as O,au as Be,ae as Ie,ab as Ae,V as Le,an as Ve,ao as Qe,aB as Ue}from"./naive-ui-CN0IOFzZ.js";import"./echarts-5QPu3XI4.js";const qe={class:"page-container"},De={key:0,class:"setup-view"},Me={class:"setting-section"},$e={class:"grid-options exam-grid"},Pe=["onClick"],Re={class:"card-info"},Ge={class:"label"},Oe={class:"desc"},Fe={class:"setting-section mt-8"},je={class:"side-panel"},He={class:"setting-section"},Xe={class:"pill-options"},Je=["onClick"],Ke={class:"setting-section mt-8"},Ye={key:0,class:"history-section mt-12"},We={class:"section-title"},Ze={class:"h-card-header"},es={class:"exam-date"},ss={class:"exam-title"},ts={class:"h-card-footer"},as={key:0,class:"pagination-wrapper mt-6"},ls={key:1,class:"testing-view"},ns={class:"testing-layout"},os={class:"test-sidebar"},is={class:"active-exam-info"},us={class:"exam-name"},rs={class:"progress-container"},cs={class:"prog-labels"},ds={class:"question-map"},vs={class:"map-grid"},ps=["onClick"],gs={class:"main-question-panel"},fs={class:"question-header"},ms={key:0,class:"listening-section mb-4"},_s={class:"passage-label"},ys={class:"audio-player"},bs={key:1,class:"reading-passage mb-4"},hs={class:"question-text"},ks={key:0,class:"options-container"},xs=["onClick"],ws={class:"letter"},Cs={class:"text"},Ss={key:1,class:"text-input-container"},Ts={class:"action-footer"},Es={class:"status-msg"},zs={key:2,class:"result-view"},Ns={class:"score-header"},Bs={class:"score-circle-container"},Is={class:"score-circle"},As={class:"score-val"},Ls={class:"stat-box"},Vs={class:"v success"},Qs={class:"stat-box"},Us={class:"v error"},qs={class:"stat-box"},Ds={class:"v"},Ms={class:"result-actions"},$s={key:3,class:"review-view"},Ps={class:"back-bar mb-6"},Rs={class:"question-text-review"},Gs={class:"review-body"},Os={class:"ans-grid"},Fs={class:"ans-item"},js={class:"ans-item"},Hs={class:"success"},Xs={key:0,class:"explanation-box"},Js={__name:"MockExamView",setup(Ks){const A=Se(),k=g(!1),q=g(null),Z=a=>{if(!a)return;if(k.value){window.speechSynthesis.cancel(),k.value=!1,q.value=null;return}const e=new SpeechSynthesisUtterance(a);e.lang="en-US",e.rate=.9,e.onend=()=>{k.value=!1,q.value=null},k.value=!0,q.value=a,window.speechSynthesis.speak(e)},F=()=>{k.value&&(window.speechSynthesis.cancel(),k.value=!1,q.value=null)},f=g("setup"),x=g(!1),M=g(!1),L=g([]),C=g(null),p=g([]),v=g(0),m=g([]),j=g(null),y=g(null),$=g(1),S=g(6),V=g({examType:"cet4",difficulty:"medium",duration:120}),ee=[{label:"å¤§å­¦è‹±è¯­å››çº§",value:"cet4",icon:"4",desc:"College English Test Band 4",color:"#10b981",bg:"rgba(16, 185, 129, 0.1)"},{label:"å¤§å­¦è‹±è¯­å…­çº§",value:"cet6",icon:"6",desc:"College English Test Band 6",color:"#6366f1",bg:"rgba(99, 102, 241, 0.1)"},{label:"é›…æ€å­¦æœ¯ç±»",value:"ielts",icon:"I",desc:"International English Language Testing System",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.1)"},{label:"æ‰˜ç¦è€ƒè¯•",value:"toefl",icon:"T",desc:"Test of English as a Foreign Language",color:"#ef4444",bg:"rgba(239, 68, 68, 0.1)"},{label:"GRE è€ƒè¯•",value:"gre",icon:"G",desc:"Graduate Record Examination",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.1)"}],se=[{label:"åˆçº§",value:"easy",icon:"ğŸŒ±"},{label:"ä¸­çº§",value:"medium",icon:"ğŸ”¥"},{label:"é«˜çº§",value:"hard",icon:"ğŸ’€"}],b=h(()=>p.value[v.value]),H=h(()=>{const a=b.value;if(!a||a.type!=="reading")return null;if(a.passage)return a.passage;if(a.text&&a.text.includes(`

`)){const e=a.text.split(`

`);if(e.length>=2)return e.slice(0,-1).join(`

`)}return null}),te=h(()=>{const a=b.value;if(!a)return"";if(a.type==="reading"&&a.text&&a.text.includes(`

`)&&!a.passage){const e=a.text.split(`

`);return e[e.length-1]}return a.text}),ae=h(()=>{const a=($.value-1)*S.value,e=a+S.value;return L.value.slice(a,e)}),le=h(()=>{const a=b.value;if(!a||a.type!=="listening"||!a.audioScript)return null;const e=p.value.filter(T=>T.type==="listening"),l=[],r=new Map;return e.forEach(T=>{r.has(T.audioScript)||(r.set(T.audioScript,l.length+1),l.push(T.audioScript))}),r.get(a.audioScript)||1}),ne=h(()=>p.value.length===0?0:Math.round((v.value+1)/p.value.length*100)),oe=h(()=>m.value.filter(a=>a!==null).length),ie=h(()=>f.value==="testing"&&C.value!==null),X=a=>{if(ie.value)return a.preventDefault(),a.returnValue="è€ƒè¯•æ­£åœ¨è¿›è¡Œä¸­ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿä½ çš„ç­”é¢˜è¿›åº¦å°†ä¼šä¸¢å¤±ã€‚",a.returnValue},J=(a,e)=>{V.value[a]=e},P=async()=>{x.value=!0;try{const a=await D.get("/exam/list",{params:{examType:""}});a.code===200&&(L.value=a.data||[])}catch(a){console.error("åŠ è½½è€ƒè¯•åˆ—è¡¨å¤±è´¥",a)}finally{x.value=!1}},ue=async()=>{M.value=!0;try{const a=await D.post("/exam/generate",{examType:V.value.examType,difficulty:V.value.difficulty});a.code===200&&(A.success("æ–°è€ƒå·å·²ç”Ÿæˆ"),await P(),a.data&&a.data.id&&K(a.data))}catch{A.error("ç”Ÿæˆè€ƒå·å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{M.value=!1}},K=async a=>{x.value=!0;try{const e=await D.get(`/exam/detail/${a.id}`);e.code===200&&e.data&&(C.value=e.data,p.value=e.data.questions||[],m.value=new Array(p.value.length).fill(null),v.value=0,j.value=Date.now(),y.value=null,f.value="testing")}catch{A.error("æ— æ³•åŠ è½½è€ƒè¯•è¯¦æƒ…")}finally{x.value=!1}},re=a=>{f.value==="testing"&&(m.value[v.value]=a)},ce=()=>{v.value>0&&v.value--},de=()=>{v.value<p.value.length-1&&v.value++};Te(v,(a,e)=>{const l=p.value[a],r=p.value[e];if(l?.type!=="listening"){F();return}r?.type==="listening"&&l?.type==="listening"&&r.audioScript!==l.audioScript&&F()});const ve=async()=>{const a=Math.round((Date.now()-j.value)/1e3);x.value=!0;try{const e=await D.post("/exam/submit",{examId:C.value.id,answers:m.value.map(l=>l===null?-1:l),timeSpent:a});e.code===200&&(y.value=e.data,f.value="result",A.success("æäº¤æˆåŠŸï¼æˆç»©å·²å­˜å…¥æ¡£æ¡ˆ"))}catch{A.error("æäº¤å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ")}finally{x.value=!1}},Y=()=>{f.value="setup",C.value=null,p.value=[],y.value=null,P()};return Ee(()=>{P(),window.addEventListener("beforeunload",X)}),ze(()=>{window.removeEventListener("beforeunload",X)}),(a,e)=>(u(),c("div",qe,[f.value==="setup"?(u(),c("div",De,[e[14]||(e[14]=s("div",{class:"page-header"},[s("h1",null,"å…¨çœŸæ¨¡æ‹Ÿè€ƒè¯•"),s("p",null,"ç”± AI é©±åŠ¨çš„é«˜ä¿çœŸè€ƒåœºæ¨¡æ‹Ÿï¼Œå…¨æ–¹ä½æ£€æµ‹å­¦ä¹ æˆæ•ˆ")],-1)),n(t(w),{class:"setup-card",bordered:!1},{default:o(()=>[n(t(R),{"x-gap":"40","y-gap":"40",cols:"1 900:3",responsive:"screen"},{default:o(()=>[n(t(z),{span:"2"},{default:o(()=>[s("div",Me,[s("h3",null,[n(t(Q),{component:t(ge),color:"#6366f1"},null,8,["component"]),e[6]||(e[6]=d(" é€‰æ‹©è€ƒè¯•é¡¹ç›®",-1))]),s("div",$e,[(u(),c(N,null,B(ee,l=>s("div",{key:l.value,class:U(["option-card",{active:V.value.examType===l.value}]),onClick:r=>J("examType",l.value)},[s("div",{class:"card-icon",style:Ne({backgroundColor:l.bg,color:l.color})},i(l.icon),5),s("div",Re,[s("div",Ge,i(l.label),1),s("div",Oe,i(l.desc),1)])],10,Pe)),64))])]),s("div",Fe,[s("h3",null,[n(t(Q),{component:t(fe),color:"#10b981"},null,8,["component"]),e[7]||(e[7]=d(" è€ƒåœºçºªå¾‹è¯´æ˜",-1))]),e[8]||(e[8]=s("div",{class:"rules-box"},[s("div",{class:"rule-item"},"æ¨¡æ‹Ÿè€ƒè¯•å¼€å¯åå°†è¿›å…¥å…¨å±/æ²‰æµ¸æ¨¡å¼ã€‚"),s("div",{class:"rule-item"},"ä¸­é€”ç¦»å¼€é¡µé¢æˆ–åˆ·æ–°å°†å¯¼è‡´è€ƒè¯•å¼ºåˆ¶ç»“æŸå¹¶ä¸è®¡åˆ†ã€‚"),s("div",{class:"rule-item"},"AI æ ¹æ®æ‚¨çš„æ°´å¹³åŠ¨æ€å‡ºé¢˜ï¼ˆå«çŸ­ç¯‡é˜…è¯»ï¼‰ã€‚"),s("div",{class:"rule-item",style:{color:"#fbbf24"}},"æ³¨ï¼šå¬åŠ›ä¸å£è¯­è€ƒè¯•è¯·å‰å¾€å¯¹åº”çš„ä¸“é¡¹è®­ç»ƒæ¨¡å—ã€‚")],-1))])]),_:1}),n(t(z),null,{default:o(()=>[s("div",je,[s("div",He,[s("h3",null,[n(t(Q),{component:t(me),color:"#f59e0b"},null,8,["component"]),e[9]||(e[9]=d(" éš¾åº¦é€‰æ‹©",-1))]),s("div",Xe,[(u(),c(N,null,B(se,l=>s("div",{key:l.value,class:U(["pill-option",{active:V.value.difficulty===l.value}]),onClick:r=>J("difficulty",l.value)},i(l.icon)+" "+i(l.label),11,Je)),64))])]),s("div",Ke,[s("h3",null,[n(t(Q),{component:t(_e),color:"#ef4444"},null,8,["component"]),e[10]||(e[10]=d(" æ—¶é—´è®¾å®š",-1))]),e[11]||(e[11]=s("div",{class:"duration-selector"},[s("div",{class:"val"},"120 åˆ†é’Ÿ"),s("p",{class:"desc"},"æ ‡å‡†è€ƒè¯•æ—¶é•¿ï¼Œè¯·ç¡®ä¿æœ‰å……è¶³æ—¶é—´ã€‚")],-1))]),n(t(G)),n(t(_),{type:"primary",size:"large",block:"",round:"",class:"start-btn",loading:M.value,onClick:ue},{icon:o(()=>[n(t(ye),{size:20})]),default:o(()=>[e[12]||(e[12]=d(" è¿›å…¥æ¨¡æ‹Ÿè€ƒåœº ",-1))]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1}),L.value.length>0?(u(),c("div",Ye,[s("div",We,[n(t(Q),{component:t(be)},null,8,["component"]),e[13]||(e[13]=d(" æœ€è¿‘ç”Ÿæˆè€ƒå· ",-1))]),n(t(R),{"x-gap":"20","y-gap":"20",cols:"1 600:2 1200:3"},{default:o(()=>[(u(!0),c(N,null,B(ae.value,l=>(u(),I(t(z),{key:l.id},{default:o(()=>[n(t(w),{class:"history-card",hoverable:"",onClick:r=>K(l)},{default:o(()=>[s("div",Ze,[n(t(O),{size:"small",bordered:!1,round:"",color:{color:"#6366f1",textColor:"#fff"}},{default:o(()=>[d(i(l.examType?.toUpperCase()),1)]),_:2},1024),s("span",es,i(new Date().toLocaleDateString()),1)]),s("h4",ss,i(l.title),1),s("div",ts,[s("span",null,[n(t(he),{size:14}),d(" "+i(l.duration)+"m",1)]),s("span",null,[n(t(ke),{size:14}),d(" "+i(l.totalQuestions)+" é¢˜",1)])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),L.value.length>S.value?(u(),c("div",as,[n(t(Be),{page:$.value,"onUpdate:page":e[0]||(e[0]=l=>$.value=l),"page-count":Math.ceil(L.value.length/S.value),"page-size":S.value,"show-size-picker":"","page-sizes":[6,12,18,24],"onUpdate:pageSize":e[1]||(e[1]=l=>S.value=l)},null,8,["page","page-count","page-size"])])):E("",!0)])):E("",!0)])):f.value==="testing"?(u(),c("div",ls,[s("div",ns,[s("div",os,[n(t(w),{class:"info-widget",bordered:!1},{default:o(()=>[s("div",is,[s("div",us,i(C.value.title),1),n(t(O),{type:"info",size:"small"},{default:o(()=>[d(i(C.value.examType?.toUpperCase())+" PRO",1)]),_:1})]),n(t(G)),s("div",rs,[s("div",cs,[e[15]||(e[15]=s("span",null,"è€ƒè¯•è¿›åº¦",-1)),s("span",null,i(v.value+1)+" / "+i(p.value.length),1)]),n(t(Ie),{type:"line",percentage:ne.value,color:"#6366f1","show-indicator":!1,circle:""},null,8,["percentage"])]),s("div",ds,[e[16]||(e[16]=s("div",{class:"map-label"},"ç­”é¢˜å¡",-1)),s("div",vs,[(u(!0),c(N,null,B(p.value.length,l=>(u(),c("div",{key:l,class:U(["map-item",{active:l-1===v.value,filled:m.value[l-1]!==null}]),onClick:r=>v.value=l-1},i(l),11,ps))),128))])]),n(t(_),{block:"",secondary:"",class:"mt-8",onClick:Y},{default:o(()=>[...e[17]||(e[17]=[d("æ”¾å¼ƒæ­¤æ¬¡è€ƒè¯•",-1)])]),_:1})]),_:1})]),s("div",gs,[n(t(w),{class:"question-card",bordered:!1},{default:o(()=>[s("div",fs,[n(t(O),{type:"primary",size:"small",class:"mb-4"},{default:o(()=>[d(i(b.value?.section||"Section"),1)]),_:1}),b.value?.type==="listening"?(u(),c("div",ms,[s("div",_s,"ğŸ“» Listening Passage "+i(le.value),1),s("div",ys,[n(t(_),{secondary:"",circle:"",type:"primary",size:"large",onClick:e[2]||(e[2]=l=>Z(b.value.audioScript))},{icon:o(()=>[k.value?(u(),I(t(we),{key:1})):(u(),I(t(xe),{key:0}))]),_:1}),e[18]||(e[18]=s("span",{class:"ml-4 text-gray-400"},"ç‚¹å‡»æ’­æ”¾å¬åŠ›ææ–™ (TTS)",-1))])])):E("",!0),H.value?(u(),c("div",bs,[n(t(w),{embedded:"",bordered:!1,class:"passage-card"},{default:o(()=>[d(i(H.value),1)]),_:1})])):E("",!0),s("h3",hs,i(te.value),1)]),["vocabulary","grammar","reading","listening"].includes(b.value?.type||"vocabulary")?(u(),c("div",ks,[(u(!0),c(N,null,B(b.value?.options,(l,r)=>(u(),c("div",{key:r,class:U(["option-item",{selected:m.value[v.value]===r}]),onClick:T=>re(r)},[s("div",ws,i(["A","B","C","D"][r]),1),s("div",Cs,i(l),1)],10,xs))),128))])):(u(),c("div",Ss,[n(t(Ae),{value:m.value[v.value],"onUpdate:value":e[3]||(e[3]=l=>m.value[v.value]=l),type:"textarea",placeholder:"è¯·è¾“å…¥æ‚¨çš„ç­”æ¡ˆ...",autosize:{minRows:10,maxRows:20},class:"essay-input"},null,8,["value"])])),s("div",Ts,[n(t(_),{disabled:v.value===0,quaternary:"",onClick:ce},{icon:o(()=>[n(t(W))]),default:o(()=>[e[19]||(e[19]=d(" PREV ",-1))]),_:1},8,["disabled"]),n(t(Le),null,{default:o(()=>[s("span",Es,"å·²ç­” "+i(oe.value)+" / "+i(p.value.length),1),v.value<p.value.length-1?(u(),I(t(_),{key:0,type:"primary",color:"#6366f1",size:"large",onClick:de},{default:o(()=>[...e[20]||(e[20]=[d(" NEXT QUESTION ",-1)])]),_:1})):(u(),I(t(_),{key:1,type:"error",size:"large",loading:x.value,onClick:ve},{default:o(()=>[...e[21]||(e[21]=[d(" æäº¤è¯•å· ",-1)])]),_:1},8,["loading"]))]),_:1})])]),_:1})])])])):f.value==="result"?(u(),c("div",zs,[n(t(w),{class:"result-card",bordered:!1},{header:o(()=>[s("div",Ns,[n(t(Ce),{size:80,color:"#f59e0b"}),e[22]||(e[22]=s("h2",null,"è€ƒè¯•æˆç»©æŠ¥å‘Š",-1))])]),default:o(()=>[s("div",Bs,[s("div",Is,[s("div",As,i(y.value.score),1),e[23]||(e[23]=s("div",{class:"score-unit"},"TOTAL SCORE",-1))])]),n(t(R),{cols:"3","x-gap":"20",class:"stat-summary"},{default:o(()=>[n(t(z),null,{default:o(()=>[s("div",Ls,[s("div",Vs,i(y.value.correctCount),1),e[24]||(e[24]=s("div",{class:"l"},"æ­£ç¡®é¢˜ç›®",-1))])]),_:1}),n(t(z),null,{default:o(()=>[s("div",Qs,[s("div",Us,i(y.value.totalCount-y.value.correctCount),1),e[25]||(e[25]=s("div",{class:"l"},"é”™è¯¯é¢˜ç›®",-1))])]),_:1}),n(t(z),null,{default:o(()=>[s("div",qs,[s("div",Ds,i(Math.floor(y.value.timeSpent/60))+"m",1),e[26]||(e[26]=s("div",{class:"l"},"æ‰€ç”¨æ—¶é—´",-1))])]),_:1})]),_:1}),n(t(G)),s("div",Ms,[n(t(_),{type:"primary",color:"#6366f1",size:"large",round:"",onClick:Y},{default:o(()=>[...e[27]||(e[27]=[d(" è¿”å›åˆ—è¡¨ ",-1)])]),_:1}),n(t(_),{secondary:"",size:"large",round:"",onClick:e[4]||(e[4]=l=>f.value="review")},{default:o(()=>[...e[28]||(e[28]=[d(" è¯¦ç»†è§£æ ",-1)])]),_:1})])]),_:1})])):f.value==="review"?(u(),c("div",$s,[s("div",Ps,[n(t(_),{secondary:"",round:"",onClick:e[5]||(e[5]=l=>f.value="result")},{icon:o(()=>[n(t(W))]),default:o(()=>[e[29]||(e[29]=d(" è¿”å›æŠ¥å‘Š ",-1))]),_:1})]),n(t(w),{class:"review-card",title:"è€ƒè¯•é¢˜ç›®å›é¡¾",bordered:!1},{default:o(()=>[n(t(Ve),null,{default:o(()=>[(u(!0),c(N,null,B(p.value,(l,r)=>(u(),I(t(Qe),{key:r},{default:o(()=>[n(t(Ue),{title:"ç¬¬ "+(r+1)+" é¢˜"},{description:o(()=>[s("p",Rs,i(l.text),1)]),default:o(()=>[s("div",Gs,[s("div",Os,[s("div",Fs,[e[30]||(e[30]=s("span",{class:"lbl"},"ä½ çš„ç­”æ¡ˆï¼š",-1)),s("span",{class:U(m.value[r]===l.correct?"success":"error")},i(m.value[r]!==null?["A","B","C","D"][m.value[r]]:"æœªä½œç­”"),3)]),s("div",js,[e[31]||(e[31]=s("span",{class:"lbl"},"æ­£ç¡®ç­”æ¡ˆï¼š",-1)),s("span",Hs,i(["A","B","C","D"][l.correct]),1)])]),l.explanation?(u(),c("div",Xs,[e[32]||(e[32]=s("strong",null,"è§£æï¼š",-1)),d(" "+i(l.explanation),1)])):E("",!0)])]),_:2},1032,["title"])]),_:2},1024))),128))]),_:1})]),_:1})])):E("",!0)]))}},st=pe(Js,[["__scopeId","data-v-7b3b8390"]]);export{st as default};
