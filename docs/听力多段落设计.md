# å¬åŠ›è®­ç»ƒ - å¤šç¯‡ç« æ ¼å¼é‡æ„æ–¹æ¡ˆ

## ç›®æ ‡
å®ç°çœŸå®è€ƒè¯•æ ¼å¼ï¼š
- ç”¨æˆ·é€‰æ‹©5ç¯‡ â†’ ç”Ÿæˆ5æ®µå¬åŠ›ææ–™
- æ¯æ®µææ–™3-5é“é¢˜
- æ¯æ®µææ–™ç‹¬ç«‹çš„éŸ³é¢‘æ’­æ”¾

## å®ç°æ­¥éª¤

### 1. åç«¯ä¿®æ”¹

#### A. ä¿®æ”¹Serviceæ¥å£ç­¾å
```java
// IAIGenerationService.java
Map<String, Object> generateListening(String type, String difficulty, Integer count);
```

#### B. ä¿®æ”¹generateListeningå®ç°
```java
// AIGenerationServiceImpl.java
@Override
public Map<String, Object> generateListening(String type, String difficulty, Integer count) {
    int passageCount = (count != null && count > 0) ? count : 1;
    
    // ç”Ÿæˆå¤šç¯‡å¬åŠ›ææ–™
    List<Map<String, Object>> passages = new ArrayList<>();
    for (int i = 0; i < passageCount; i++) {
        Map<String, Object> passage = callDashScopeForSinglePassage(type, difficulty, i + 1);
        passages.add(passage);
    }
    
    Map<String, Object> result = new HashMap<>();
    result.put("passages", passages);
    result.put("totalPassages", passageCount);
    
    return result;
}
```

#### C. ä¿®æ”¹AI Prompt
```java
private Map<String, Object> callDashScopeForSinglePassage(String type, String difficulty, int passageNumber) {
    String prompt = String.format(
        "Generate ONE listening passage (Passage %d). " +
        "Type: %s, Difficulty: %s. " +
        "Include 3-5 questions for this passage. " +
        "Return: { \"title\": \"Passage %d: ...\", \"script\": \"...\", \"questions\": [...] }",
        passageNumber, type, difficulty, passageNumber
    );
    // ... call LLM
}
```

#### D. ä¿®æ”¹Controller
```java
// AIGenerationController.java
@PostMapping("/listening/generate")
public Result generateListening(@RequestBody Map<String, Object> params) {
    String type = (String) params.get("type");
    String difficulty = (String) params.get("difficulty");
    Integer count = params.get("count") != null ? (Integer) params.get("count") : 1;
    
    Map<String, Object> result = aiGenerationService.generateListening(type, difficulty, count);
    return Result.success(result);
}
```

### 2. å‰ç«¯ä¿®æ”¹

#### A. ä¿®æ”¹æ•°æ®ç»“æ„
```javascript
// ListeningView.vue
const passages = ref([])  // å¤šä¸ªç¯‡ç« 
const currentPassageIndex = ref(0)  // å½“å‰ç¯‡ç« ç´¢å¼•
const currentQuestionIndex = ref(0)  // å½“å‰é¢˜ç›®åœ¨passageä¸­çš„ç´¢å¼•

const currentPassage = computed(() => passages.value[currentPassageIndex.value])
const currentQuestion = computed(() => {
    return currentPassage.value?.questions[currentQuestionIndex.value]
})
```

#### B. ä¿®æ”¹æ’­æ”¾é€»è¾‘
```javascript
const playAudio = () => {
    const script = currentPassage.value?.script
    // åªæ’­æ”¾å½“å‰ç¯‡ç« çš„éŸ³é¢‘
    speakText(script)
}
```

#### C. ä¿®æ”¹é¢˜ç›®å¯¼èˆª
```vue
<div class="passage-navigator">
  <div v-for="(passage, pIdx) in passages" :key="pIdx" class="passage-group">
    <div class="passage-header">Passage {{ pIdx + 1 }}</div>
    <div class="question-numbers">
      <div v-for="(q, qIdx) in passage.questions" :key="q.id"
           @click="jumpToQuestion(pIdx, qIdx)"
           :class="{ active: isCurrentQuestion(pIdx, qIdx) }">
        {{ q.id }}
      </div>
    </div>
  </div>
</div>
```

#### D. ä¿®æ”¹UIå¸ƒå±€
```vue
<div class="listening-test">
  <!-- å½“å‰ç¯‡ç« ä¿¡æ¯ -->
  <div class="passage-info">
    <h3>{{ currentPassage.title }}</h3>
    <button @click="playAudio">ğŸ”Š æ’­æ”¾ Passage {{ currentPassageIndex + 1 }}</button>
  </div>
  
  <!-- é¢˜ç›® -->
  <div class="question">
    <p>Question {{ currentQuestion.id }}: {{ currentQuestion.question }}</p>
    <!-- options -->
  </div>
  
  <!-- å¯¼èˆª -->
  <button @click="nextQuestion">ä¸‹ä¸€é¢˜</button>
</div>
```

### 3. å®æ–½ä¼˜å…ˆçº§
1. âœ… ä¿®æ”¹åç«¯Serviceæ¥å£å’Œå®ç°
2. âœ… ä¿®æ”¹Controlleræ¥å—countå‚æ•°
3. âœ… ä¿®æ”¹AI Promptç”Ÿæˆå¤šç¯‡ç« 
4. âœ… ä¿®æ”¹å‰ç«¯æ•°æ®ç»“æ„
5. âœ… ä¿®æ”¹å‰ç«¯UIå’Œäº¤äº’é€»è¾‘

## é¢„æœŸæ•ˆæœ
- ç”¨æˆ·é€‰æ‹©5ç¯‡ â†’ ç”Ÿæˆ5æ®µç‹¬ç«‹çš„å¬åŠ›ææ–™
- æ¯æ®µææ–™æœ‰è‡ªå·±çš„æ ‡é¢˜ã€æ–‡æœ¬ã€é¢˜ç›®
- æ’­æ”¾éŸ³é¢‘æ—¶åªæ’­æ”¾å½“å‰ç¯‡ç« 
- é¢˜ç›®å¯¼èˆªæŒ‰ç¯‡ç« åˆ†ç»„æ˜¾ç¤º
